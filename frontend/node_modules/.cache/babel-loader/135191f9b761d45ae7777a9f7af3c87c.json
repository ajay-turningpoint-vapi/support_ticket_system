{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.error_handling.js)\r\n * Version: 20.1.7\r\n * Build date: Tue Aug 25 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _click = require(\"../../events/click\");\n\nvar _click2 = _interopRequireDefault(_click);\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar ERROR_ROW_CLASS = \"dx-error-row\";\nvar ERROR_MESSAGE_CLASS = \"dx-error-message\";\nvar ERROR_CLOSEBUTTON_CLASS = \"dx-closebutton\";\nvar ACTION_CLASS = \"action\";\n\nvar ErrorHandlingController = _uiGrid_core2.default.ViewController.inherit({\n  init: function () {\n    var that = this;\n    that._columnHeadersView = that.getView(\"columnHeadersView\");\n    that._rowsView = that.getView(\"rowsView\");\n  },\n  _createErrorRow: function (error, $tableElements) {\n    var that = this;\n    var $errorRow;\n    var $closeButton;\n\n    var $errorMessage = this._renderErrorMessage(error);\n\n    if ($tableElements) {\n      $errorRow = (0, _renderer2.default)(\"<tr>\").addClass(ERROR_ROW_CLASS);\n      $closeButton = (0, _renderer2.default)(\"<div>\").addClass(ERROR_CLOSEBUTTON_CLASS).addClass(that.addWidgetPrefix(ACTION_CLASS));\n\n      _events_engine2.default.on($closeButton, _click2.default.name, that.createAction(function (args) {\n        var e = args.event;\n        var $errorRow;\n        var errorRowIndex = (0, _renderer2.default)(e.currentTarget).closest(\".\" + ERROR_ROW_CLASS).index();\n        e.stopPropagation();\n        (0, _iterator.each)($tableElements, function (_, tableElement) {\n          $errorRow = (0, _renderer2.default)(tableElement).children(\"tbody\").children(\"tr\").eq(errorRowIndex);\n          that.removeErrorRow($errorRow);\n        });\n        that.getController(\"resizing\") && that.getController(\"resizing\").fireContentReadyAction();\n      }));\n\n      (0, _renderer2.default)(\"<td>\").attr({\n        colSpan: that.getController(\"columns\").getVisibleColumns().length,\n        role: \"presentation\"\n      }).prepend($closeButton).append($errorMessage).appendTo($errorRow);\n      return $errorRow;\n    }\n\n    return $errorMessage;\n  },\n  _renderErrorMessage: function (error) {\n    var message = error.url ? error.message.replace(error.url, \"\") : error.message || error;\n    var $message = (0, _renderer2.default)(\"<div>\").addClass(ERROR_MESSAGE_CLASS).text(message);\n\n    if (error.url) {\n      (0, _renderer2.default)(\"<a>\").attr(\"href\", error.url).text(error.url).appendTo($message);\n    }\n\n    return $message;\n  },\n  renderErrorRow: function (error, rowIndex, $popupContent) {\n    var that = this;\n    var $errorMessageElement;\n    var $firstErrorRow;\n\n    if ($popupContent) {\n      $popupContent.find(\".\" + ERROR_MESSAGE_CLASS).remove();\n      $errorMessageElement = that._createErrorRow(error);\n      $popupContent.prepend($errorMessageElement);\n      return $errorMessageElement;\n    }\n\n    var viewElement = rowIndex >= 0 || !that._columnHeadersView.isVisible() ? that._rowsView : that._columnHeadersView;\n    var $tableElements = $popupContent || viewElement.getTableElements();\n    (0, _iterator.each)($tableElements, function (_, tableElement) {\n      $errorMessageElement = that._createErrorRow(error, $tableElements);\n      $firstErrorRow = $firstErrorRow || $errorMessageElement;\n\n      if (rowIndex >= 0) {\n        var $row = viewElement._getRowElements((0, _renderer2.default)(tableElement)).eq(rowIndex);\n\n        that.removeErrorRow($row.next());\n        $errorMessageElement.insertAfter($row);\n      } else {\n        var $tbody = (0, _renderer2.default)(tableElement).children(\"tbody\");\n        var rowElements = $tbody.children(\"tr\");\n\n        if (that._columnHeadersView.isVisible()) {\n          that.removeErrorRow(rowElements.last());\n          (0, _renderer2.default)(tableElement).append($errorMessageElement);\n        } else {\n          that.removeErrorRow(rowElements.first());\n          $tbody.first().prepend($errorMessageElement);\n        }\n      }\n    });\n\n    if (!$popupContent) {\n      var resizingController = that.getController(\"resizing\");\n      resizingController && resizingController.fireContentReadyAction();\n    }\n\n    return $firstErrorRow;\n  },\n  removeErrorRow: function ($row) {\n    if (!$row) {\n      var $columnHeaders = this._columnHeadersView && this._columnHeadersView.element();\n\n      $row = $columnHeaders && $columnHeaders.find(\".\" + ERROR_ROW_CLASS);\n\n      if (!$row || !$row.length) {\n        var $rowsViewElement = this._rowsView.element();\n\n        $row = $rowsViewElement && $rowsViewElement.find(\".\" + ERROR_ROW_CLASS);\n      }\n    }\n\n    $row && $row.hasClass(ERROR_ROW_CLASS) && $row.remove();\n  },\n  optionChanged: function (args) {\n    var that = this;\n\n    switch (args.name) {\n      case \"errorRowEnabled\":\n        args.handled = true;\n        break;\n\n      default:\n        that.callBase(args);\n    }\n  }\n});\n\nmodule.exports = {\n  defaultOptions: function () {\n    return {\n      errorRowEnabled: true\n    };\n  },\n  controllers: {\n    errorHandling: ErrorHandlingController\n  },\n  extenders: {\n    controllers: {\n      data: {\n        init: function () {\n          var that = this;\n          var errorHandlingController = that.getController(\"errorHandling\");\n          that.callBase();\n          that.dataErrorOccurred.add(function (error, $popupContent) {\n            if (that.option(\"errorRowEnabled\")) {\n              errorHandlingController.renderErrorRow(error, void 0, $popupContent);\n            }\n          });\n          that.changed.add(function (e) {\n            if (e && \"loadError\" === e.changeType) {\n              return;\n            }\n\n            var errorHandlingController = that.getController(\"errorHandling\");\n            var editingController = that.getController(\"editing\");\n\n            if (editingController && !editingController.hasChanges()) {\n              errorHandlingController && errorHandlingController.removeErrorRow();\n            }\n          });\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/ticketSystem/frontend/node_modules/devextreme/ui/grid_core/ui.grid_core.error_handling.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_events_engine","_events_engine2","_click","_click2","_iterator","_uiGrid_core","_uiGrid_core2","obj","__esModule","ERROR_ROW_CLASS","ERROR_MESSAGE_CLASS","ERROR_CLOSEBUTTON_CLASS","ACTION_CLASS","ErrorHandlingController","default","ViewController","inherit","init","that","_columnHeadersView","getView","_rowsView","_createErrorRow","error","$tableElements","$errorRow","$closeButton","$errorMessage","_renderErrorMessage","addClass","addWidgetPrefix","on","name","createAction","args","e","event","errorRowIndex","currentTarget","closest","index","stopPropagation","each","_","tableElement","children","eq","removeErrorRow","getController","fireContentReadyAction","attr","colSpan","getVisibleColumns","length","role","prepend","append","appendTo","message","url","replace","$message","text","renderErrorRow","rowIndex","$popupContent","$errorMessageElement","$firstErrorRow","find","remove","viewElement","isVisible","getTableElements","$row","_getRowElements","next","insertAfter","$tbody","rowElements","last","first","resizingController","$columnHeaders","element","$rowsViewElement","hasClass","optionChanged","handled","callBase","module","exports","defaultOptions","errorRowEnabled","controllers","errorHandling","extenders","data","errorHandlingController","dataErrorOccurred","add","option","changed","changeType","editingController","hasChanges"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.error_handling.js)\r\n * Version: 20.1.7\r\n * Build date: Tue Aug 25 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _click = require(\"../../events/click\");\r\nvar _click2 = _interopRequireDefault(_click);\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar ERROR_ROW_CLASS = \"dx-error-row\";\r\nvar ERROR_MESSAGE_CLASS = \"dx-error-message\";\r\nvar ERROR_CLOSEBUTTON_CLASS = \"dx-closebutton\";\r\nvar ACTION_CLASS = \"action\";\r\nvar ErrorHandlingController = _uiGrid_core2.default.ViewController.inherit({\r\n    init: function() {\r\n        var that = this;\r\n        that._columnHeadersView = that.getView(\"columnHeadersView\");\r\n        that._rowsView = that.getView(\"rowsView\")\r\n    },\r\n    _createErrorRow: function(error, $tableElements) {\r\n        var that = this;\r\n        var $errorRow;\r\n        var $closeButton;\r\n        var $errorMessage = this._renderErrorMessage(error);\r\n        if ($tableElements) {\r\n            $errorRow = (0, _renderer2.default)(\"<tr>\").addClass(ERROR_ROW_CLASS);\r\n            $closeButton = (0, _renderer2.default)(\"<div>\").addClass(ERROR_CLOSEBUTTON_CLASS).addClass(that.addWidgetPrefix(ACTION_CLASS));\r\n            _events_engine2.default.on($closeButton, _click2.default.name, that.createAction(function(args) {\r\n                var e = args.event;\r\n                var $errorRow;\r\n                var errorRowIndex = (0, _renderer2.default)(e.currentTarget).closest(\".\" + ERROR_ROW_CLASS).index();\r\n                e.stopPropagation();\r\n                (0, _iterator.each)($tableElements, function(_, tableElement) {\r\n                    $errorRow = (0, _renderer2.default)(tableElement).children(\"tbody\").children(\"tr\").eq(errorRowIndex);\r\n                    that.removeErrorRow($errorRow)\r\n                });\r\n                that.getController(\"resizing\") && that.getController(\"resizing\").fireContentReadyAction()\r\n            }));\r\n            (0, _renderer2.default)(\"<td>\").attr({\r\n                colSpan: that.getController(\"columns\").getVisibleColumns().length,\r\n                role: \"presentation\"\r\n            }).prepend($closeButton).append($errorMessage).appendTo($errorRow);\r\n            return $errorRow\r\n        }\r\n        return $errorMessage\r\n    },\r\n    _renderErrorMessage: function(error) {\r\n        var message = error.url ? error.message.replace(error.url, \"\") : error.message || error;\r\n        var $message = (0, _renderer2.default)(\"<div>\").addClass(ERROR_MESSAGE_CLASS).text(message);\r\n        if (error.url) {\r\n            (0, _renderer2.default)(\"<a>\").attr(\"href\", error.url).text(error.url).appendTo($message)\r\n        }\r\n        return $message\r\n    },\r\n    renderErrorRow: function(error, rowIndex, $popupContent) {\r\n        var that = this;\r\n        var $errorMessageElement;\r\n        var $firstErrorRow;\r\n        if ($popupContent) {\r\n            $popupContent.find(\".\" + ERROR_MESSAGE_CLASS).remove();\r\n            $errorMessageElement = that._createErrorRow(error);\r\n            $popupContent.prepend($errorMessageElement);\r\n            return $errorMessageElement\r\n        }\r\n        var viewElement = rowIndex >= 0 || !that._columnHeadersView.isVisible() ? that._rowsView : that._columnHeadersView;\r\n        var $tableElements = $popupContent || viewElement.getTableElements();\r\n        (0, _iterator.each)($tableElements, function(_, tableElement) {\r\n            $errorMessageElement = that._createErrorRow(error, $tableElements);\r\n            $firstErrorRow = $firstErrorRow || $errorMessageElement;\r\n            if (rowIndex >= 0) {\r\n                var $row = viewElement._getRowElements((0, _renderer2.default)(tableElement)).eq(rowIndex);\r\n                that.removeErrorRow($row.next());\r\n                $errorMessageElement.insertAfter($row)\r\n            } else {\r\n                var $tbody = (0, _renderer2.default)(tableElement).children(\"tbody\");\r\n                var rowElements = $tbody.children(\"tr\");\r\n                if (that._columnHeadersView.isVisible()) {\r\n                    that.removeErrorRow(rowElements.last());\r\n                    (0, _renderer2.default)(tableElement).append($errorMessageElement)\r\n                } else {\r\n                    that.removeErrorRow(rowElements.first());\r\n                    $tbody.first().prepend($errorMessageElement)\r\n                }\r\n            }\r\n        });\r\n        if (!$popupContent) {\r\n            var resizingController = that.getController(\"resizing\");\r\n            resizingController && resizingController.fireContentReadyAction()\r\n        }\r\n        return $firstErrorRow\r\n    },\r\n    removeErrorRow: function($row) {\r\n        if (!$row) {\r\n            var $columnHeaders = this._columnHeadersView && this._columnHeadersView.element();\r\n            $row = $columnHeaders && $columnHeaders.find(\".\" + ERROR_ROW_CLASS);\r\n            if (!$row || !$row.length) {\r\n                var $rowsViewElement = this._rowsView.element();\r\n                $row = $rowsViewElement && $rowsViewElement.find(\".\" + ERROR_ROW_CLASS)\r\n            }\r\n        }\r\n        $row && $row.hasClass(ERROR_ROW_CLASS) && $row.remove()\r\n    },\r\n    optionChanged: function(args) {\r\n        var that = this;\r\n        switch (args.name) {\r\n            case \"errorRowEnabled\":\r\n                args.handled = true;\r\n                break;\r\n            default:\r\n                that.callBase(args)\r\n        }\r\n    }\r\n});\r\nmodule.exports = {\r\n    defaultOptions: function() {\r\n        return {\r\n            errorRowEnabled: true\r\n        }\r\n    },\r\n    controllers: {\r\n        errorHandling: ErrorHandlingController\r\n    },\r\n    extenders: {\r\n        controllers: {\r\n            data: {\r\n                init: function() {\r\n                    var that = this;\r\n                    var errorHandlingController = that.getController(\"errorHandling\");\r\n                    that.callBase();\r\n                    that.dataErrorOccurred.add(function(error, $popupContent) {\r\n                        if (that.option(\"errorRowEnabled\")) {\r\n                            errorHandlingController.renderErrorRow(error, void 0, $popupContent)\r\n                        }\r\n                    });\r\n                    that.changed.add(function(e) {\r\n                        if (e && \"loadError\" === e.changeType) {\r\n                            return\r\n                        }\r\n                        var errorHandlingController = that.getController(\"errorHandling\");\r\n                        var editingController = that.getController(\"editing\");\r\n                        if (editingController && !editingController.hasChanges()) {\r\n                            errorHandlingController && errorHandlingController.removeErrorRow()\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"script"}