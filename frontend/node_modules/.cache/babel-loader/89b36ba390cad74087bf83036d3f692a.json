{"ast":null,"code":"/**\r\n * DevExtreme (data/data_source/data_source.js)\r\n * Version: 20.1.7\r\n * Build date: Tue Aug 25 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DataSource = void 0;\n\nvar _class = require(\"../../core/class\");\n\nvar _class2 = _interopRequireDefault(_class);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _common2 = _interopRequireDefault(_common);\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _utils = require(\"../utils\");\n\nvar _array_utils = require(\"../array_utils\");\n\nvar _array_utils2 = _interopRequireDefault(_array_utils);\n\nvar _custom_store = require(\"../custom_store\");\n\nvar _custom_store2 = _interopRequireDefault(_custom_store);\n\nvar _events_strategy = require(\"../../core/events_strategy\");\n\nvar _errors = require(\"../errors\");\n\nvar _array = require(\"../../core/utils/array\");\n\nvar _array2 = _interopRequireDefault(_array);\n\nvar _queue = require(\"../../core/utils/queue\");\n\nvar _queue2 = _interopRequireDefault(_queue);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _operation_manager = require(\"./operation_manager\");\n\nvar _operation_manager2 = _interopRequireDefault(_operation_manager);\n\nvar _utils2 = require(\"./utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar DataSource = exports.DataSource = _class2.default.inherit({\n  ctor: function (options) {\n    var _options$reshapeOnPus,\n        _this = this;\n\n    options = (0, _utils2.normalizeDataSourceOptions)(options);\n    this._eventsStrategy = new _events_strategy.EventsStrategy(this);\n    var onPushHandler = 0 !== options.pushAggregationTimeout ? (0, _utils.throttleChanges)(this._onPush, function () {\n      return void 0 === options.pushAggregationTimeout ? 5 * _this._changedTime : options.pushAggregationTimeout;\n    }) : this._onPush;\n    this._changedTime = 0;\n\n    this._onPushHandler = function (changes) {\n      _this._aggregationTimeoutId = onPushHandler.call(_this, changes);\n    };\n\n    this._store = options.store;\n\n    this._store.on(\"push\", this._onPushHandler);\n\n    this._storeLoadOptions = this._extractLoadOptions(options);\n    this._mapFunc = options.map;\n    this._postProcessFunc = options.postProcess;\n    this._pageIndex = void 0 !== options.pageIndex ? options.pageIndex : 0;\n    this._pageSize = void 0 !== options.pageSize ? options.pageSize : 20;\n    this._loadingCount = 0;\n    this._loadQueue = this._createLoadQueue();\n    this._searchValue = \"searchValue\" in options ? options.searchValue : null;\n    this._searchOperation = options.searchOperation || \"contains\";\n    this._searchExpr = options.searchExpr;\n    this._paginate = options.paginate;\n    this._reshapeOnPush = null !== (_options$reshapeOnPus = options.reshapeOnPush) && void 0 !== _options$reshapeOnPus ? _options$reshapeOnPus : false;\n    (0, _iterator.each)([\"onChanged\", \"onLoadError\", \"onLoadingChanged\", \"onCustomizeLoadResult\", \"onCustomizeStoreLoadOptions\"], function (_, optionName) {\n      if (optionName in options) {\n        _this.on(optionName.substr(2, 1).toLowerCase() + optionName.substr(3), options[optionName]);\n      }\n    });\n    this._operationManager = new _operation_manager2.default();\n\n    this._init();\n  },\n  _init: function () {\n    this._items = [];\n    this._userData = {};\n    this._totalCount = -1;\n    this._isLoaded = false;\n\n    if (!(0, _type.isDefined)(this._paginate)) {\n      this._paginate = !this.group();\n    }\n\n    this._isLastPage = !this._paginate;\n  },\n  dispose: function () {\n    var _this$_delayedLoadTas;\n\n    this._store.off(\"push\", this._onPushHandler);\n\n    this._eventsStrategy.dispose();\n\n    clearTimeout(this._aggregationTimeoutId);\n    delete this._store;\n    null === (_this$_delayedLoadTas = this._delayedLoadTask) || void 0 === _this$_delayedLoadTas ? void 0 : _this$_delayedLoadTas.abort();\n\n    this._operationManager.cancelAll();\n\n    this._disposed = true;\n  },\n  _extractLoadOptions: function (options) {\n    var result = {};\n    var names = [\"sort\", \"filter\", \"select\", \"group\", \"requireTotalCount\"];\n\n    var customNames = this._store._customLoadOptions();\n\n    if (customNames) {\n      names = names.concat(customNames);\n    }\n\n    (0, _iterator.each)(names, function () {\n      result[this] = options[this];\n    });\n    return result;\n  },\n  loadOptions: function () {\n    return this._storeLoadOptions;\n  },\n  items: function () {\n    return this._items;\n  },\n  pageIndex: function (newIndex) {\n    if (!(0, _type.isNumeric)(newIndex)) {\n      return this._pageIndex;\n    }\n\n    this._pageIndex = newIndex;\n    this._isLastPage = !this._paginate;\n  },\n  paginate: function (value) {\n    if (!(0, _type.isBoolean)(value)) {\n      return this._paginate;\n    }\n\n    if (this._paginate !== value) {\n      this._paginate = value;\n      this.pageIndex(0);\n    }\n  },\n  pageSize: function (value) {\n    if (!(0, _type.isNumeric)(value)) {\n      return this._pageSize;\n    }\n\n    this._pageSize = value;\n  },\n  isLastPage: function () {\n    return this._isLastPage;\n  },\n  generateStoreLoadOptionAccessor: function (optionName) {\n    var _this2 = this;\n\n    return function (args) {\n      var normalizedArgs = (0, _utils2.normalizeStoreLoadOptionAccessorArguments)(args);\n\n      if (void 0 === normalizedArgs) {\n        return _this2._storeLoadOptions[optionName];\n      }\n\n      _this2._storeLoadOptions[optionName] = normalizedArgs;\n    };\n  },\n  sort: function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return this.generateStoreLoadOptionAccessor(\"sort\")(args);\n  },\n  filter: function () {\n    var newFilter = (0, _utils2.normalizeStoreLoadOptionAccessorArguments)(arguments);\n\n    if (void 0 === newFilter) {\n      return this._storeLoadOptions.filter;\n    }\n\n    this._storeLoadOptions.filter = newFilter;\n    this.pageIndex(0);\n  },\n  group: function () {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    return this.generateStoreLoadOptionAccessor(\"group\")(args);\n  },\n  select: function () {\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    return this.generateStoreLoadOptionAccessor(\"select\")(args);\n  },\n  requireTotalCount: function (value) {\n    if (!(0, _type.isBoolean)(value)) {\n      return this._storeLoadOptions.requireTotalCount;\n    }\n\n    this._storeLoadOptions.requireTotalCount = value;\n  },\n  searchValue: function (value) {\n    if (arguments.length < 1) {\n      return this._searchValue;\n    }\n\n    this._searchValue = value;\n    this.pageIndex(0);\n  },\n  searchOperation: function (op) {\n    if (!(0, _type.isString)(op)) {\n      return this._searchOperation;\n    }\n\n    this._searchOperation = op;\n    this.pageIndex(0);\n  },\n  searchExpr: function (expr) {\n    var argc = arguments.length;\n\n    if (0 === argc) {\n      return this._searchExpr;\n    }\n\n    if (argc > 1) {\n      expr = [].slice.call(arguments);\n    }\n\n    this._searchExpr = expr;\n    this.pageIndex(0);\n  },\n  store: function () {\n    return this._store;\n  },\n  key: function () {\n    var _this$_store;\n\n    return null === (_this$_store = this._store) || void 0 === _this$_store ? void 0 : _this$_store.key();\n  },\n  totalCount: function () {\n    return this._totalCount;\n  },\n  isLoaded: function () {\n    return this._isLoaded;\n  },\n  isLoading: function () {\n    return this._loadingCount > 0;\n  },\n  beginLoading: function () {\n    this._changeLoadingCount(1);\n  },\n  endLoading: function () {\n    this._changeLoadingCount(-1);\n  },\n  _createLoadQueue: function () {\n    return _queue2.default.create();\n  },\n  _changeLoadingCount: function (increment) {\n    var oldLoading = this.isLoading();\n    this._loadingCount += increment;\n    var newLoading = this.isLoading();\n\n    if (oldLoading ^ newLoading) {\n      this._eventsStrategy.fireEvent(\"loadingChanged\", [newLoading]);\n    }\n  },\n  _scheduleLoadCallbacks: function (deferred) {\n    var _this3 = this;\n\n    this.beginLoading();\n    deferred.always(function () {\n      _this3.endLoading();\n    });\n  },\n  _scheduleFailCallbacks: function (deferred) {\n    var _this4 = this;\n\n    deferred.fail(function () {\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n\n      if (args[0] === _utils2.CANCELED_TOKEN) {\n        return;\n      }\n\n      _this4._eventsStrategy.fireEvent(\"loadError\", args);\n    });\n  },\n  _fireChanged: function (args) {\n    var date = new Date();\n\n    this._eventsStrategy.fireEvent(\"changed\", args);\n\n    this._changedTime = new Date() - date;\n  },\n  _scheduleChangedCallbacks: function (deferred) {\n    var _this5 = this;\n\n    deferred.done(function () {\n      return _this5._fireChanged();\n    });\n  },\n  loadSingle: function (propName, propValue) {\n    var _this6 = this;\n\n    var d = new _deferred.Deferred();\n    var key = this.key();\n    var store = this._store;\n\n    var options = this._createStoreLoadOptions();\n\n    var handleDone = function (data) {\n      if (!(0, _type.isDefined)(data) || _array2.default.isEmpty(data)) {\n        d.reject(new _errors.errors.Error(\"E4009\"));\n      } else {\n        if (!Array.isArray(data)) {\n          data = [data];\n        }\n\n        d.resolve(_this6._applyMapFunction(data)[0]);\n      }\n    };\n\n    this._scheduleFailCallbacks(d);\n\n    if (arguments.length < 2) {\n      propValue = propName;\n      propName = key;\n    }\n\n    delete options.skip;\n    delete options.group;\n    delete options.refresh;\n    delete options.pageIndex;\n    delete options.searchString;\n\n    var shouldForceByKey = function () {\n      return store instanceof _custom_store2.default && !store._byKeyViaLoad();\n    };\n\n    (function () {\n      if (propName === key || shouldForceByKey()) {\n        return store.byKey(propValue, options);\n      }\n\n      options.take = 1;\n      options.filter = options.filter ? [options.filter, [propName, propValue]] : [propName, propValue];\n      return store.load(options);\n    })().fail(d.reject).done(handleDone);\n    return d.promise();\n  },\n  load: function () {\n    var _this7 = this;\n\n    var d = new _deferred.Deferred();\n\n    var loadTask = function () {\n      if (_this7._disposed) {\n        return;\n      }\n\n      if (!(0, _utils2.isPending)(d)) {\n        return;\n      }\n\n      return _this7._loadFromStore(loadOperation, d);\n    };\n\n    this._scheduleLoadCallbacks(d);\n\n    this._scheduleFailCallbacks(d);\n\n    this._scheduleChangedCallbacks(d);\n\n    var loadOperation = this._createLoadOperation(d);\n\n    this._eventsStrategy.fireEvent(\"customizeStoreLoadOptions\", [loadOperation]);\n\n    this._loadQueue.add(function () {\n      if (\"number\" === typeof loadOperation.delay) {\n        _this7._delayedLoadTask = _common2.default.executeAsync(loadTask, loadOperation.delay);\n      } else {\n        loadTask();\n      }\n\n      return d.promise();\n    });\n\n    return d.promise({\n      operationId: loadOperation.operationId\n    });\n  },\n  _onPush: function (changes) {\n    var _this8 = this;\n\n    if (this._reshapeOnPush) {\n      this.load();\n    } else {\n      this._eventsStrategy.fireEvent(\"changing\", [{\n        changes: changes\n      }]);\n\n      var group = this.group();\n      var items = this.items();\n      var groupLevel = 0;\n      var dataSourceChanges = this.paginate() || group ? changes.filter(function (item) {\n        return \"update\" === item.type;\n      }) : changes;\n\n      if (group) {\n        groupLevel = Array.isArray(group) ? group.length : 1;\n      }\n\n      if (this._mapFunc) {\n        dataSourceChanges.forEach(function (item) {\n          if (\"insert\" === item.type) {\n            item.data = _this8._mapFunc(item.data);\n          }\n        });\n      }\n\n      _array_utils2.default.applyBatch(this.store(), items, dataSourceChanges, groupLevel, true);\n\n      this._fireChanged([{\n        changes: changes\n      }]);\n    }\n  },\n  _createLoadOperation: function (deferred) {\n    var _this9 = this;\n\n    var operationId = this._operationManager.add(deferred);\n\n    var storeLoadOptions = this._createStoreLoadOptions();\n\n    deferred.always(function () {\n      return _this9._operationManager.remove(operationId);\n    });\n    return {\n      operationId: operationId,\n      storeLoadOptions: storeLoadOptions\n    };\n  },\n  reload: function () {\n    var store = this.store();\n\n    if (store instanceof _custom_store2.default) {\n      store.clearRawDataCache();\n    }\n\n    this._init();\n\n    return this.load();\n  },\n  cancel: function (operationId) {\n    return this._operationManager.cancel(operationId);\n  },\n  cancelAll: function () {\n    return this._operationManager.cancelAll();\n  },\n  _addSearchOptions: function (storeLoadOptions) {\n    if (this._disposed) {\n      return;\n    }\n\n    if (this.store()._useDefaultSearch) {\n      this._addSearchFilter(storeLoadOptions);\n    } else {\n      storeLoadOptions.searchOperation = this._searchOperation;\n      storeLoadOptions.searchValue = this._searchValue;\n      storeLoadOptions.searchExpr = this._searchExpr;\n    }\n  },\n  _createStoreLoadOptions: function () {\n    var result = (0, _extend.extend)({}, this._storeLoadOptions);\n\n    this._addSearchOptions(result);\n\n    if (this._paginate) {\n      if (this._pageSize) {\n        result.skip = this._pageIndex * this._pageSize;\n        result.take = this._pageSize;\n      }\n    }\n\n    result.userData = this._userData;\n    return result;\n  },\n  _addSearchFilter: function (storeLoadOptions) {\n    var value = this._searchValue;\n    var op = this._searchOperation;\n    var selector = this._searchExpr;\n    var searchFilter = [];\n\n    if (!value) {\n      return;\n    }\n\n    if (!selector) {\n      selector = \"this\";\n    }\n\n    if (!Array.isArray(selector)) {\n      selector = [selector];\n    }\n\n    (0, _iterator.each)(selector, function (i, item) {\n      if (searchFilter.length) {\n        searchFilter.push(\"or\");\n      }\n\n      searchFilter.push([item, op, value]);\n    });\n\n    if (storeLoadOptions.filter) {\n      storeLoadOptions.filter = [searchFilter, storeLoadOptions.filter];\n    } else {\n      storeLoadOptions.filter = searchFilter;\n    }\n  },\n  _loadFromStore: function (loadOptions, pendingDeferred) {\n    var _this10 = this;\n\n    var handleSuccess = function (data, extra) {\n      if (_this10._disposed) {\n        return;\n      }\n\n      if (!(0, _utils2.isPending)(pendingDeferred)) {\n        return;\n      }\n\n      var loadResult = (0, _extend.extend)((0, _utils2.normalizeLoadResult)(data, extra), loadOptions);\n\n      _this10._eventsStrategy.fireEvent(\"customizeLoadResult\", [loadResult]);\n\n      (0, _deferred.when)(loadResult.data).done(function (data) {\n        loadResult.data = data;\n\n        _this10._processStoreLoadResult(loadResult, pendingDeferred);\n      }).fail(pendingDeferred.reject);\n    };\n\n    if (loadOptions.data) {\n      return new _deferred.Deferred().resolve(loadOptions.data).done(handleSuccess);\n    }\n\n    return this.store().load(loadOptions.storeLoadOptions).done(handleSuccess).fail(pendingDeferred.reject);\n  },\n  _processStoreLoadResult: function (loadResult, pendingDeferred) {\n    var _this11 = this;\n\n    var data = loadResult.data;\n    var extra = loadResult.extra;\n    var storeLoadOptions = loadResult.storeLoadOptions;\n\n    var resolvePendingDeferred = function () {\n      _this11._isLoaded = true;\n      _this11._totalCount = isFinite(extra.totalCount) ? extra.totalCount : -1;\n      return pendingDeferred.resolve(data, extra);\n    };\n\n    var proceedLoadingTotalCount = function () {\n      _this11.store().totalCount(storeLoadOptions).done(function (count) {\n        extra.totalCount = count;\n        resolvePendingDeferred();\n      }).fail(pendingDeferred.reject);\n    };\n\n    if (this._disposed) {\n      return;\n    }\n\n    data = this._applyPostProcessFunction(this._applyMapFunction(data));\n\n    if (!(0, _type.isPlainObject)(extra)) {\n      extra = {};\n    }\n\n    this._items = data;\n\n    if (!data.length || !this._paginate || this._pageSize && data.length < this._pageSize) {\n      this._isLastPage = true;\n    }\n\n    if (storeLoadOptions.requireTotalCount && !isFinite(extra.totalCount)) {\n      proceedLoadingTotalCount();\n    } else {\n      resolvePendingDeferred();\n    }\n  },\n  _applyMapFunction: function (data) {\n    if (this._mapFunc) {\n      return (0, _utils2.mapDataRespectingGrouping)(data, this._mapFunc, this.group());\n    }\n\n    return data;\n  },\n  _applyPostProcessFunction: function (data) {\n    if (this._postProcessFunc) {\n      return this._postProcessFunc(data);\n    }\n\n    return data;\n  },\n  on: function (eventName, eventHandler) {\n    this._eventsStrategy.on(eventName, eventHandler);\n\n    return this;\n  },\n  off: function (eventName, eventHandler) {\n    this._eventsStrategy.off(eventName, eventHandler);\n\n    return this;\n  }\n});","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/ticketSystem/frontend/node_modules/devextreme/data/data_source/data_source.js"],"names":["Object","defineProperty","exports","value","DataSource","_class","require","_class2","_interopRequireDefault","_extend","_common","_common2","_iterator","_type","_utils","_array_utils","_array_utils2","_custom_store","_custom_store2","_events_strategy","_errors","_array","_array2","_queue","_queue2","_deferred","_operation_manager","_operation_manager2","_utils2","obj","__esModule","default","inherit","ctor","options","_options$reshapeOnPus","_this","normalizeDataSourceOptions","_eventsStrategy","EventsStrategy","onPushHandler","pushAggregationTimeout","throttleChanges","_onPush","_changedTime","_onPushHandler","changes","_aggregationTimeoutId","call","_store","store","on","_storeLoadOptions","_extractLoadOptions","_mapFunc","map","_postProcessFunc","postProcess","_pageIndex","pageIndex","_pageSize","pageSize","_loadingCount","_loadQueue","_createLoadQueue","_searchValue","searchValue","_searchOperation","searchOperation","_searchExpr","searchExpr","_paginate","paginate","_reshapeOnPush","reshapeOnPush","each","_","optionName","substr","toLowerCase","_operationManager","_init","_items","_userData","_totalCount","_isLoaded","isDefined","group","_isLastPage","dispose","_this$_delayedLoadTas","off","clearTimeout","_delayedLoadTask","abort","cancelAll","_disposed","result","names","customNames","_customLoadOptions","concat","loadOptions","items","newIndex","isNumeric","isBoolean","isLastPage","generateStoreLoadOptionAccessor","_this2","args","normalizedArgs","normalizeStoreLoadOptionAccessorArguments","sort","_len","arguments","length","Array","_key","filter","newFilter","_len2","_key2","select","_len3","_key3","requireTotalCount","op","isString","expr","argc","slice","key","_this$_store","totalCount","isLoaded","isLoading","beginLoading","_changeLoadingCount","endLoading","create","increment","oldLoading","newLoading","fireEvent","_scheduleLoadCallbacks","deferred","_this3","always","_scheduleFailCallbacks","_this4","fail","_len4","_key4","CANCELED_TOKEN","_fireChanged","date","Date","_scheduleChangedCallbacks","_this5","done","loadSingle","propName","propValue","_this6","d","Deferred","_createStoreLoadOptions","handleDone","data","isEmpty","reject","errors","Error","isArray","resolve","_applyMapFunction","skip","refresh","searchString","shouldForceByKey","_byKeyViaLoad","byKey","take","load","promise","_this7","loadTask","isPending","_loadFromStore","loadOperation","_createLoadOperation","add","delay","executeAsync","operationId","_this8","groupLevel","dataSourceChanges","item","type","forEach","applyBatch","_this9","storeLoadOptions","remove","reload","clearRawDataCache","cancel","_addSearchOptions","_useDefaultSearch","_addSearchFilter","extend","userData","selector","searchFilter","i","push","pendingDeferred","_this10","handleSuccess","extra","loadResult","normalizeLoadResult","when","_processStoreLoadResult","_this11","resolvePendingDeferred","isFinite","proceedLoadingTotalCount","count","_applyPostProcessFunction","isPlainObject","mapDataRespectingGrouping","eventName","eventHandler"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (data/data_source/data_source.js)\r\n * Version: 20.1.7\r\n * Build date: Tue Aug 25 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\nexports.DataSource = void 0;\r\nvar _class = require(\"../../core/class\");\r\nvar _class2 = _interopRequireDefault(_class);\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _common2 = _interopRequireDefault(_common);\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _utils = require(\"../utils\");\r\nvar _array_utils = require(\"../array_utils\");\r\nvar _array_utils2 = _interopRequireDefault(_array_utils);\r\nvar _custom_store = require(\"../custom_store\");\r\nvar _custom_store2 = _interopRequireDefault(_custom_store);\r\nvar _events_strategy = require(\"../../core/events_strategy\");\r\nvar _errors = require(\"../errors\");\r\nvar _array = require(\"../../core/utils/array\");\r\nvar _array2 = _interopRequireDefault(_array);\r\nvar _queue = require(\"../../core/utils/queue\");\r\nvar _queue2 = _interopRequireDefault(_queue);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _operation_manager = require(\"./operation_manager\");\r\nvar _operation_manager2 = _interopRequireDefault(_operation_manager);\r\nvar _utils2 = require(\"./utils\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar DataSource = exports.DataSource = _class2.default.inherit({\r\n    ctor: function(options) {\r\n        var _options$reshapeOnPus, _this = this;\r\n        options = (0, _utils2.normalizeDataSourceOptions)(options);\r\n        this._eventsStrategy = new _events_strategy.EventsStrategy(this);\r\n        var onPushHandler = 0 !== options.pushAggregationTimeout ? (0, _utils.throttleChanges)(this._onPush, function() {\r\n            return void 0 === options.pushAggregationTimeout ? 5 * _this._changedTime : options.pushAggregationTimeout\r\n        }) : this._onPush;\r\n        this._changedTime = 0;\r\n        this._onPushHandler = function(changes) {\r\n            _this._aggregationTimeoutId = onPushHandler.call(_this, changes)\r\n        };\r\n        this._store = options.store;\r\n        this._store.on(\"push\", this._onPushHandler);\r\n        this._storeLoadOptions = this._extractLoadOptions(options);\r\n        this._mapFunc = options.map;\r\n        this._postProcessFunc = options.postProcess;\r\n        this._pageIndex = void 0 !== options.pageIndex ? options.pageIndex : 0;\r\n        this._pageSize = void 0 !== options.pageSize ? options.pageSize : 20;\r\n        this._loadingCount = 0;\r\n        this._loadQueue = this._createLoadQueue();\r\n        this._searchValue = \"searchValue\" in options ? options.searchValue : null;\r\n        this._searchOperation = options.searchOperation || \"contains\";\r\n        this._searchExpr = options.searchExpr;\r\n        this._paginate = options.paginate;\r\n        this._reshapeOnPush = null !== (_options$reshapeOnPus = options.reshapeOnPush) && void 0 !== _options$reshapeOnPus ? _options$reshapeOnPus : false;\r\n        (0, _iterator.each)([\"onChanged\", \"onLoadError\", \"onLoadingChanged\", \"onCustomizeLoadResult\", \"onCustomizeStoreLoadOptions\"], function(_, optionName) {\r\n            if (optionName in options) {\r\n                _this.on(optionName.substr(2, 1).toLowerCase() + optionName.substr(3), options[optionName])\r\n            }\r\n        });\r\n        this._operationManager = new _operation_manager2.default;\r\n        this._init()\r\n    },\r\n    _init: function() {\r\n        this._items = [];\r\n        this._userData = {};\r\n        this._totalCount = -1;\r\n        this._isLoaded = false;\r\n        if (!(0, _type.isDefined)(this._paginate)) {\r\n            this._paginate = !this.group()\r\n        }\r\n        this._isLastPage = !this._paginate\r\n    },\r\n    dispose: function() {\r\n        var _this$_delayedLoadTas;\r\n        this._store.off(\"push\", this._onPushHandler);\r\n        this._eventsStrategy.dispose();\r\n        clearTimeout(this._aggregationTimeoutId);\r\n        delete this._store;\r\n        null === (_this$_delayedLoadTas = this._delayedLoadTask) || void 0 === _this$_delayedLoadTas ? void 0 : _this$_delayedLoadTas.abort();\r\n        this._operationManager.cancelAll();\r\n        this._disposed = true\r\n    },\r\n    _extractLoadOptions: function(options) {\r\n        var result = {};\r\n        var names = [\"sort\", \"filter\", \"select\", \"group\", \"requireTotalCount\"];\r\n        var customNames = this._store._customLoadOptions();\r\n        if (customNames) {\r\n            names = names.concat(customNames)\r\n        }(0, _iterator.each)(names, function() {\r\n            result[this] = options[this]\r\n        });\r\n        return result\r\n    },\r\n    loadOptions: function() {\r\n        return this._storeLoadOptions\r\n    },\r\n    items: function() {\r\n        return this._items\r\n    },\r\n    pageIndex: function(newIndex) {\r\n        if (!(0, _type.isNumeric)(newIndex)) {\r\n            return this._pageIndex\r\n        }\r\n        this._pageIndex = newIndex;\r\n        this._isLastPage = !this._paginate\r\n    },\r\n    paginate: function(value) {\r\n        if (!(0, _type.isBoolean)(value)) {\r\n            return this._paginate\r\n        }\r\n        if (this._paginate !== value) {\r\n            this._paginate = value;\r\n            this.pageIndex(0)\r\n        }\r\n    },\r\n    pageSize: function(value) {\r\n        if (!(0, _type.isNumeric)(value)) {\r\n            return this._pageSize\r\n        }\r\n        this._pageSize = value\r\n    },\r\n    isLastPage: function() {\r\n        return this._isLastPage\r\n    },\r\n    generateStoreLoadOptionAccessor: function(optionName) {\r\n        var _this2 = this;\r\n        return function(args) {\r\n            var normalizedArgs = (0, _utils2.normalizeStoreLoadOptionAccessorArguments)(args);\r\n            if (void 0 === normalizedArgs) {\r\n                return _this2._storeLoadOptions[optionName]\r\n            }\r\n            _this2._storeLoadOptions[optionName] = normalizedArgs\r\n        }\r\n    },\r\n    sort: function() {\r\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\r\n            args[_key] = arguments[_key]\r\n        }\r\n        return this.generateStoreLoadOptionAccessor(\"sort\")(args)\r\n    },\r\n    filter: function() {\r\n        var newFilter = (0, _utils2.normalizeStoreLoadOptionAccessorArguments)(arguments);\r\n        if (void 0 === newFilter) {\r\n            return this._storeLoadOptions.filter\r\n        }\r\n        this._storeLoadOptions.filter = newFilter;\r\n        this.pageIndex(0)\r\n    },\r\n    group: function() {\r\n        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\r\n            args[_key2] = arguments[_key2]\r\n        }\r\n        return this.generateStoreLoadOptionAccessor(\"group\")(args)\r\n    },\r\n    select: function() {\r\n        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\r\n            args[_key3] = arguments[_key3]\r\n        }\r\n        return this.generateStoreLoadOptionAccessor(\"select\")(args)\r\n    },\r\n    requireTotalCount: function(value) {\r\n        if (!(0, _type.isBoolean)(value)) {\r\n            return this._storeLoadOptions.requireTotalCount\r\n        }\r\n        this._storeLoadOptions.requireTotalCount = value\r\n    },\r\n    searchValue: function(value) {\r\n        if (arguments.length < 1) {\r\n            return this._searchValue\r\n        }\r\n        this._searchValue = value;\r\n        this.pageIndex(0)\r\n    },\r\n    searchOperation: function(op) {\r\n        if (!(0, _type.isString)(op)) {\r\n            return this._searchOperation\r\n        }\r\n        this._searchOperation = op;\r\n        this.pageIndex(0)\r\n    },\r\n    searchExpr: function(expr) {\r\n        var argc = arguments.length;\r\n        if (0 === argc) {\r\n            return this._searchExpr\r\n        }\r\n        if (argc > 1) {\r\n            expr = [].slice.call(arguments)\r\n        }\r\n        this._searchExpr = expr;\r\n        this.pageIndex(0)\r\n    },\r\n    store: function() {\r\n        return this._store\r\n    },\r\n    key: function() {\r\n        var _this$_store;\r\n        return null === (_this$_store = this._store) || void 0 === _this$_store ? void 0 : _this$_store.key()\r\n    },\r\n    totalCount: function() {\r\n        return this._totalCount\r\n    },\r\n    isLoaded: function() {\r\n        return this._isLoaded\r\n    },\r\n    isLoading: function() {\r\n        return this._loadingCount > 0\r\n    },\r\n    beginLoading: function() {\r\n        this._changeLoadingCount(1)\r\n    },\r\n    endLoading: function() {\r\n        this._changeLoadingCount(-1)\r\n    },\r\n    _createLoadQueue: function() {\r\n        return _queue2.default.create()\r\n    },\r\n    _changeLoadingCount: function(increment) {\r\n        var oldLoading = this.isLoading();\r\n        this._loadingCount += increment;\r\n        var newLoading = this.isLoading();\r\n        if (oldLoading ^ newLoading) {\r\n            this._eventsStrategy.fireEvent(\"loadingChanged\", [newLoading])\r\n        }\r\n    },\r\n    _scheduleLoadCallbacks: function(deferred) {\r\n        var _this3 = this;\r\n        this.beginLoading();\r\n        deferred.always(function() {\r\n            _this3.endLoading()\r\n        })\r\n    },\r\n    _scheduleFailCallbacks: function(deferred) {\r\n        var _this4 = this;\r\n        deferred.fail(function() {\r\n            for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\r\n                args[_key4] = arguments[_key4]\r\n            }\r\n            if (args[0] === _utils2.CANCELED_TOKEN) {\r\n                return\r\n            }\r\n            _this4._eventsStrategy.fireEvent(\"loadError\", args)\r\n        })\r\n    },\r\n    _fireChanged: function(args) {\r\n        var date = new Date;\r\n        this._eventsStrategy.fireEvent(\"changed\", args);\r\n        this._changedTime = new Date - date\r\n    },\r\n    _scheduleChangedCallbacks: function(deferred) {\r\n        var _this5 = this;\r\n        deferred.done(function() {\r\n            return _this5._fireChanged()\r\n        })\r\n    },\r\n    loadSingle: function(propName, propValue) {\r\n        var _this6 = this;\r\n        var d = new _deferred.Deferred;\r\n        var key = this.key();\r\n        var store = this._store;\r\n        var options = this._createStoreLoadOptions();\r\n        var handleDone = function(data) {\r\n            if (!(0, _type.isDefined)(data) || _array2.default.isEmpty(data)) {\r\n                d.reject(new _errors.errors.Error(\"E4009\"))\r\n            } else {\r\n                if (!Array.isArray(data)) {\r\n                    data = [data]\r\n                }\r\n                d.resolve(_this6._applyMapFunction(data)[0])\r\n            }\r\n        };\r\n        this._scheduleFailCallbacks(d);\r\n        if (arguments.length < 2) {\r\n            propValue = propName;\r\n            propName = key\r\n        }\r\n        delete options.skip;\r\n        delete options.group;\r\n        delete options.refresh;\r\n        delete options.pageIndex;\r\n        delete options.searchString;\r\n        var shouldForceByKey = function() {\r\n            return store instanceof _custom_store2.default && !store._byKeyViaLoad()\r\n        };\r\n        (function() {\r\n            if (propName === key || shouldForceByKey()) {\r\n                return store.byKey(propValue, options)\r\n            }\r\n            options.take = 1;\r\n            options.filter = options.filter ? [options.filter, [propName, propValue]] : [propName, propValue];\r\n            return store.load(options)\r\n        })().fail(d.reject).done(handleDone);\r\n        return d.promise()\r\n    },\r\n    load: function() {\r\n        var _this7 = this;\r\n        var d = new _deferred.Deferred;\r\n        var loadTask = function() {\r\n            if (_this7._disposed) {\r\n                return\r\n            }\r\n            if (!(0, _utils2.isPending)(d)) {\r\n                return\r\n            }\r\n            return _this7._loadFromStore(loadOperation, d)\r\n        };\r\n        this._scheduleLoadCallbacks(d);\r\n        this._scheduleFailCallbacks(d);\r\n        this._scheduleChangedCallbacks(d);\r\n        var loadOperation = this._createLoadOperation(d);\r\n        this._eventsStrategy.fireEvent(\"customizeStoreLoadOptions\", [loadOperation]);\r\n        this._loadQueue.add(function() {\r\n            if (\"number\" === typeof loadOperation.delay) {\r\n                _this7._delayedLoadTask = _common2.default.executeAsync(loadTask, loadOperation.delay)\r\n            } else {\r\n                loadTask()\r\n            }\r\n            return d.promise()\r\n        });\r\n        return d.promise({\r\n            operationId: loadOperation.operationId\r\n        })\r\n    },\r\n    _onPush: function(changes) {\r\n        var _this8 = this;\r\n        if (this._reshapeOnPush) {\r\n            this.load()\r\n        } else {\r\n            this._eventsStrategy.fireEvent(\"changing\", [{\r\n                changes: changes\r\n            }]);\r\n            var group = this.group();\r\n            var items = this.items();\r\n            var groupLevel = 0;\r\n            var dataSourceChanges = this.paginate() || group ? changes.filter(function(item) {\r\n                return \"update\" === item.type\r\n            }) : changes;\r\n            if (group) {\r\n                groupLevel = Array.isArray(group) ? group.length : 1\r\n            }\r\n            if (this._mapFunc) {\r\n                dataSourceChanges.forEach(function(item) {\r\n                    if (\"insert\" === item.type) {\r\n                        item.data = _this8._mapFunc(item.data)\r\n                    }\r\n                })\r\n            }\r\n            _array_utils2.default.applyBatch(this.store(), items, dataSourceChanges, groupLevel, true);\r\n            this._fireChanged([{\r\n                changes: changes\r\n            }])\r\n        }\r\n    },\r\n    _createLoadOperation: function(deferred) {\r\n        var _this9 = this;\r\n        var operationId = this._operationManager.add(deferred);\r\n        var storeLoadOptions = this._createStoreLoadOptions();\r\n        deferred.always(function() {\r\n            return _this9._operationManager.remove(operationId)\r\n        });\r\n        return {\r\n            operationId: operationId,\r\n            storeLoadOptions: storeLoadOptions\r\n        }\r\n    },\r\n    reload: function() {\r\n        var store = this.store();\r\n        if (store instanceof _custom_store2.default) {\r\n            store.clearRawDataCache()\r\n        }\r\n        this._init();\r\n        return this.load()\r\n    },\r\n    cancel: function(operationId) {\r\n        return this._operationManager.cancel(operationId)\r\n    },\r\n    cancelAll: function() {\r\n        return this._operationManager.cancelAll()\r\n    },\r\n    _addSearchOptions: function(storeLoadOptions) {\r\n        if (this._disposed) {\r\n            return\r\n        }\r\n        if (this.store()._useDefaultSearch) {\r\n            this._addSearchFilter(storeLoadOptions)\r\n        } else {\r\n            storeLoadOptions.searchOperation = this._searchOperation;\r\n            storeLoadOptions.searchValue = this._searchValue;\r\n            storeLoadOptions.searchExpr = this._searchExpr\r\n        }\r\n    },\r\n    _createStoreLoadOptions: function() {\r\n        var result = (0, _extend.extend)({}, this._storeLoadOptions);\r\n        this._addSearchOptions(result);\r\n        if (this._paginate) {\r\n            if (this._pageSize) {\r\n                result.skip = this._pageIndex * this._pageSize;\r\n                result.take = this._pageSize\r\n            }\r\n        }\r\n        result.userData = this._userData;\r\n        return result\r\n    },\r\n    _addSearchFilter: function(storeLoadOptions) {\r\n        var value = this._searchValue;\r\n        var op = this._searchOperation;\r\n        var selector = this._searchExpr;\r\n        var searchFilter = [];\r\n        if (!value) {\r\n            return\r\n        }\r\n        if (!selector) {\r\n            selector = \"this\"\r\n        }\r\n        if (!Array.isArray(selector)) {\r\n            selector = [selector]\r\n        }(0, _iterator.each)(selector, function(i, item) {\r\n            if (searchFilter.length) {\r\n                searchFilter.push(\"or\")\r\n            }\r\n            searchFilter.push([item, op, value])\r\n        });\r\n        if (storeLoadOptions.filter) {\r\n            storeLoadOptions.filter = [searchFilter, storeLoadOptions.filter]\r\n        } else {\r\n            storeLoadOptions.filter = searchFilter\r\n        }\r\n    },\r\n    _loadFromStore: function(loadOptions, pendingDeferred) {\r\n        var _this10 = this;\r\n        var handleSuccess = function(data, extra) {\r\n            if (_this10._disposed) {\r\n                return\r\n            }\r\n            if (!(0, _utils2.isPending)(pendingDeferred)) {\r\n                return\r\n            }\r\n            var loadResult = (0, _extend.extend)((0, _utils2.normalizeLoadResult)(data, extra), loadOptions);\r\n            _this10._eventsStrategy.fireEvent(\"customizeLoadResult\", [loadResult]);\r\n            (0, _deferred.when)(loadResult.data).done(function(data) {\r\n                loadResult.data = data;\r\n                _this10._processStoreLoadResult(loadResult, pendingDeferred)\r\n            }).fail(pendingDeferred.reject)\r\n        };\r\n        if (loadOptions.data) {\r\n            return (new _deferred.Deferred).resolve(loadOptions.data).done(handleSuccess)\r\n        }\r\n        return this.store().load(loadOptions.storeLoadOptions).done(handleSuccess).fail(pendingDeferred.reject)\r\n    },\r\n    _processStoreLoadResult: function(loadResult, pendingDeferred) {\r\n        var _this11 = this;\r\n        var data = loadResult.data;\r\n        var extra = loadResult.extra;\r\n        var storeLoadOptions = loadResult.storeLoadOptions;\r\n        var resolvePendingDeferred = function() {\r\n            _this11._isLoaded = true;\r\n            _this11._totalCount = isFinite(extra.totalCount) ? extra.totalCount : -1;\r\n            return pendingDeferred.resolve(data, extra)\r\n        };\r\n        var proceedLoadingTotalCount = function() {\r\n            _this11.store().totalCount(storeLoadOptions).done(function(count) {\r\n                extra.totalCount = count;\r\n                resolvePendingDeferred()\r\n            }).fail(pendingDeferred.reject)\r\n        };\r\n        if (this._disposed) {\r\n            return\r\n        }\r\n        data = this._applyPostProcessFunction(this._applyMapFunction(data));\r\n        if (!(0, _type.isPlainObject)(extra)) {\r\n            extra = {}\r\n        }\r\n        this._items = data;\r\n        if (!data.length || !this._paginate || this._pageSize && data.length < this._pageSize) {\r\n            this._isLastPage = true\r\n        }\r\n        if (storeLoadOptions.requireTotalCount && !isFinite(extra.totalCount)) {\r\n            proceedLoadingTotalCount()\r\n        } else {\r\n            resolvePendingDeferred()\r\n        }\r\n    },\r\n    _applyMapFunction: function(data) {\r\n        if (this._mapFunc) {\r\n            return (0, _utils2.mapDataRespectingGrouping)(data, this._mapFunc, this.group())\r\n        }\r\n        return data\r\n    },\r\n    _applyPostProcessFunction: function(data) {\r\n        if (this._postProcessFunc) {\r\n            return this._postProcessFunc(data)\r\n        }\r\n        return data\r\n    },\r\n    on: function(eventName, eventHandler) {\r\n        this._eventsStrategy.on(eventName, eventHandler);\r\n        return this\r\n    },\r\n    off: function(eventName, eventHandler) {\r\n        this._eventsStrategy.off(eventName, eventHandler);\r\n        return this\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"script"}