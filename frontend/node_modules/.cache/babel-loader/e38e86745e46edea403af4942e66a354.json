{"ast":null,"code":"/**\r\n * DevExtreme (ui/filter_builder/filter_builder.js)\r\n * Version: 20.1.7\r\n * Build date: Tue Aug 25 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _dom_adapter = require(\"../../core/dom_adapter\");\n\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\n\nvar _class = require(\"../../core/class\");\n\nvar _class2 = _interopRequireDefault(_class);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _ui = require(\"../widget/ui.widget\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _utils = require(\"./utils\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _deferred2 = _interopRequireDefault(_deferred);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _tree_view = require(\"../tree_view\");\n\nvar _tree_view2 = _interopRequireDefault(_tree_view);\n\nvar _popup = require(\"../popup\");\n\nvar _popup2 = _interopRequireDefault(_popup);\n\nvar _utils3 = require(\"../overlay/utils\");\n\nvar _ui3 = require(\"../shared/ui.editor_factory_mixin\");\n\nvar _ui4 = _interopRequireDefault(_ui3);\n\nvar _utils4 = require(\"../../events/utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar FILTER_BUILDER_CLASS = \"dx-filterbuilder\";\nvar FILTER_BUILDER_GROUP_CLASS = FILTER_BUILDER_CLASS + \"-group\";\nvar FILTER_BUILDER_GROUP_ITEM_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-item\";\nvar FILTER_BUILDER_GROUP_CONTENT_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-content\";\nvar FILTER_BUILDER_GROUP_OPERATIONS_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-operations\";\nvar FILTER_BUILDER_GROUP_OPERATION_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-operation\";\nvar FILTER_BUILDER_ACTION_CLASS = FILTER_BUILDER_CLASS + \"-action\";\nvar FILTER_BUILDER_IMAGE_CLASS = FILTER_BUILDER_ACTION_CLASS + \"-icon\";\nvar FILTER_BUILDER_IMAGE_ADD_CLASS = \"dx-icon-plus\";\nvar FILTER_BUILDER_IMAGE_REMOVE_CLASS = \"dx-icon-remove\";\nvar FILTER_BUILDER_ITEM_TEXT_CLASS = FILTER_BUILDER_CLASS + \"-text\";\nvar FILTER_BUILDER_ITEM_TEXT_PART_CLASS = FILTER_BUILDER_ITEM_TEXT_CLASS + \"-part\";\nvar FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS = FILTER_BUILDER_ITEM_TEXT_CLASS + \"-separator\";\nvar FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS = FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS + \"-empty\";\nvar FILTER_BUILDER_ITEM_FIELD_CLASS = FILTER_BUILDER_CLASS + \"-item-field\";\nvar FILTER_BUILDER_ITEM_OPERATION_CLASS = FILTER_BUILDER_CLASS + \"-item-operation\";\nvar FILTER_BUILDER_ITEM_VALUE_CLASS = FILTER_BUILDER_CLASS + \"-item-value\";\nvar FILTER_BUILDER_ITEM_VALUE_TEXT_CLASS = FILTER_BUILDER_CLASS + \"-item-value-text\";\nvar FILTER_BUILDER_OVERLAY_CLASS = FILTER_BUILDER_CLASS + \"-overlay\";\nvar FILTER_BUILDER_FILTER_OPERATIONS_CLASS = FILTER_BUILDER_CLASS + \"-operations\";\nvar FILTER_BUILDER_FIELDS_CLASS = FILTER_BUILDER_CLASS + \"-fields\";\nvar FILTER_BUILDER_ADD_CONDITION_CLASS = FILTER_BUILDER_CLASS + \"-add-condition\";\nvar ACTIVE_CLASS = \"dx-state-active\";\nvar FILTER_BUILDER_MENU_CUSTOM_OPERATION_CLASS = FILTER_BUILDER_CLASS + \"-menu-custom-operation\";\nvar SOURCE = \"filterBuilder\";\nvar DISABLED_STATE_CLASS = \"dx-state-disabled\";\nvar TAB_KEY = \"tab\";\nvar ENTER_KEY = \"enter\";\nvar ESCAPE_KEY = \"escape\";\nvar ACTIONS = [{\n  name: \"onEditorPreparing\",\n  config: {\n    excludeValidators: [\"disabled\", \"readOnly\"],\n    category: \"rendering\"\n  }\n}, {\n  name: \"onEditorPrepared\",\n  config: {\n    excludeValidators: [\"disabled\", \"readOnly\"],\n    category: \"rendering\"\n  }\n}, {\n  name: \"onValueChanged\",\n  config: {\n    excludeValidators: [\"disabled\", \"readOnly\"]\n  }\n}];\nvar OPERATORS = {\n  and: \"and\",\n  or: \"or\",\n  notAnd: \"!and\",\n  notOr: \"!or\"\n};\n\nvar EditorFactory = _class2.default.inherit(_ui4.default);\n\nvar renderValueText = function ($container, value, customOperation) {\n  if (Array.isArray(value)) {\n    var lastItemIndex = value.length - 1;\n    $container.empty();\n    value.forEach(function (t, i) {\n      (0, _renderer2.default)(\"<span>\").addClass(FILTER_BUILDER_ITEM_TEXT_PART_CLASS).text(t).appendTo($container);\n\n      if (i !== lastItemIndex) {\n        (0, _renderer2.default)(\"<span>\").addClass(FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS).text(customOperation && customOperation.valueSeparator ? customOperation.valueSeparator : \"|\").addClass(FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS).appendTo($container);\n      }\n    });\n  } else {\n    if (value) {\n      $container.text(value);\n    } else {\n      $container.text(_message2.default.format(\"dxFilterBuilder-enterValueText\"));\n    }\n  }\n};\n\nvar FilterBuilder = _ui2.default.inherit({\n  _getDefaultOptions: function () {\n    return (0, _extend.extend)(this.callBase(), {\n      onEditorPreparing: null,\n      onEditorPrepared: null,\n      onValueChanged: null,\n      fields: [],\n      defaultGroupOperation: \"and\",\n      groupOperations: [\"and\", \"or\", \"notAnd\", \"notOr\"],\n      maxGroupLevel: void 0,\n      value: null,\n      allowHierarchicalFields: false,\n      groupOperationDescriptions: {\n        and: _message2.default.format(\"dxFilterBuilder-and\"),\n        or: _message2.default.format(\"dxFilterBuilder-or\"),\n        notAnd: _message2.default.format(\"dxFilterBuilder-notAnd\"),\n        notOr: _message2.default.format(\"dxFilterBuilder-notOr\")\n      },\n      customOperations: [],\n      closePopupOnTargetScroll: true,\n      filterOperationDescriptions: {\n        between: _message2.default.format(\"dxFilterBuilder-filterOperationBetween\"),\n        equal: _message2.default.format(\"dxFilterBuilder-filterOperationEquals\"),\n        notEqual: _message2.default.format(\"dxFilterBuilder-filterOperationNotEquals\"),\n        lessThan: _message2.default.format(\"dxFilterBuilder-filterOperationLess\"),\n        lessThanOrEqual: _message2.default.format(\"dxFilterBuilder-filterOperationLessOrEquals\"),\n        greaterThan: _message2.default.format(\"dxFilterBuilder-filterOperationGreater\"),\n        greaterThanOrEqual: _message2.default.format(\"dxFilterBuilder-filterOperationGreaterOrEquals\"),\n        startsWith: _message2.default.format(\"dxFilterBuilder-filterOperationStartsWith\"),\n        contains: _message2.default.format(\"dxFilterBuilder-filterOperationContains\"),\n        notContains: _message2.default.format(\"dxFilterBuilder-filterOperationNotContains\"),\n        endsWith: _message2.default.format(\"dxFilterBuilder-filterOperationEndsWith\"),\n        isBlank: _message2.default.format(\"dxFilterBuilder-filterOperationIsBlank\"),\n        isNotBlank: _message2.default.format(\"dxFilterBuilder-filterOperationIsNotBlank\")\n      }\n    });\n  },\n  _optionChanged: function (args) {\n    switch (args.name) {\n      case \"closePopupOnTargetScroll\":\n        break;\n\n      case \"onEditorPreparing\":\n      case \"onEditorPrepared\":\n      case \"onValueChanged\":\n        this._initActions();\n\n        break;\n\n      case \"customOperations\":\n        this._initCustomOperations();\n\n        this._invalidate();\n\n        break;\n\n      case \"fields\":\n      case \"defaultGroupOperation\":\n      case \"maxGroupLevel\":\n      case \"groupOperations\":\n      case \"allowHierarchicalFields\":\n      case \"groupOperationDescriptions\":\n      case \"filterOperationDescriptions\":\n        this._invalidate();\n\n        break;\n\n      case \"value\":\n        if (args.value !== args.previousValue) {\n          var disableInvalidateForValue = this._disableInvalidateForValue;\n\n          if (!disableInvalidateForValue) {\n            this._initModel();\n\n            this._invalidate();\n          }\n\n          this._disableInvalidateForValue = false;\n          this.executeAction(\"onValueChanged\", {\n            value: args.value,\n            previousValue: args.previousValue\n          });\n          this._disableInvalidateForValue = disableInvalidateForValue;\n        }\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  getFilterExpression: function () {\n    var fields = this._getNormalizedFields();\n\n    var value = (0, _extend.extend)(true, [], this._model);\n    return _utils2.default.getFilterExpression(_utils2.default.getNormalizedFilter(value), fields, this._customOperations, SOURCE);\n  },\n  _getNormalizedFields: function () {\n    return _utils2.default.getNormalizedFields(this.option(\"fields\"));\n  },\n  _updateFilter: function () {\n    this._disableInvalidateForValue = true;\n    var value = (0, _extend.extend)(true, [], this._model);\n\n    var normalizedValue = _utils2.default.getNormalizedFilter(value);\n\n    var oldValue = _utils2.default.getNormalizedFilter(this._getModel(this.option(\"value\")));\n\n    if (JSON.stringify(oldValue) !== JSON.stringify(normalizedValue)) {\n      this.option(\"value\", normalizedValue);\n    }\n\n    this._disableInvalidateForValue = false;\n\n    this._fireContentReadyAction();\n  },\n  _init: function () {\n    this._initCustomOperations();\n\n    this._initModel();\n\n    this._initEditorFactory();\n\n    this._initActions();\n\n    this.callBase();\n  },\n  _initEditorFactory: function () {\n    this._editorFactory = new EditorFactory();\n  },\n  _initCustomOperations: function () {\n    this._customOperations = _utils2.default.getMergedOperations(this.option(\"customOperations\"), this.option(\"filterOperationDescriptions.between\"), this);\n  },\n  _getModel: function (value) {\n    return _utils2.default.convertToInnerStructure(value, this._customOperations);\n  },\n  _initModel: function () {\n    this._model = this._getModel(this.option(\"value\"));\n  },\n  _initActions: function () {\n    var that = this;\n    that._actions = {};\n    ACTIONS.forEach(function (action) {\n      that._actions[action.name] = that._createActionByOption(action.name, action.config);\n    });\n  },\n  executeAction: function (actionName, options) {\n    var action = this._actions[actionName];\n    return action && action(options);\n  },\n  _initMarkup: function () {\n    this.$element().addClass(FILTER_BUILDER_CLASS);\n    this.callBase();\n\n    this._createGroupElementByCriteria(this._model).appendTo(this.$element());\n  },\n  _createConditionElement: function (condition, parent) {\n    return (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_CLASS).append(this._createConditionItem(condition, parent));\n  },\n  _createGroupElementByCriteria: function (criteria, parent) {\n    var groupLevel = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0;\n\n    var $group = this._createGroupElement(criteria, parent, groupLevel);\n\n    var $groupContent = $group.find(\".\" + FILTER_BUILDER_GROUP_CONTENT_CLASS);\n\n    var groupCriteria = _utils2.default.getGroupCriteria(criteria);\n\n    for (var i = 0; i < groupCriteria.length; i++) {\n      var innerCriteria = groupCriteria[i];\n\n      if (_utils2.default.isGroup(innerCriteria)) {\n        this._createGroupElementByCriteria(innerCriteria, groupCriteria, groupLevel + 1).appendTo($groupContent);\n      } else {\n        if (_utils2.default.isCondition(innerCriteria)) {\n          this._createConditionElement(innerCriteria, groupCriteria).appendTo($groupContent);\n        }\n      }\n    }\n\n    return $group;\n  },\n  _createGroupElement: function (criteria, parent, groupLevel) {\n    var _this = this;\n\n    var $groupItem = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_ITEM_CLASS);\n    var $groupContent = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_CONTENT_CLASS);\n    var $group = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_CLASS).append($groupItem).append($groupContent);\n\n    if (null != parent) {\n      this._createRemoveButton(function () {\n        _utils2.default.removeItem(parent, criteria);\n\n        $group.remove();\n\n        _this._updateFilter();\n      }).appendTo($groupItem);\n    }\n\n    this._createGroupOperationButton(criteria).appendTo($groupItem);\n\n    this._createAddButton(function () {\n      var newGroup = _utils2.default.createEmptyGroup(_this.option(\"defaultGroupOperation\"));\n\n      _utils2.default.addItem(newGroup, criteria);\n\n      _this._createGroupElement(newGroup, criteria, groupLevel + 1).appendTo($groupContent);\n\n      _this._updateFilter();\n    }, function () {\n      var field = _this.option(\"fields\")[0];\n\n      var newCondition = _utils2.default.createCondition(field, _this._customOperations);\n\n      _utils2.default.addItem(newCondition, criteria);\n\n      _this._createConditionElement(newCondition, criteria).appendTo($groupContent);\n\n      _this._updateFilter();\n    }, groupLevel).appendTo($groupItem);\n\n    return $group;\n  },\n  _createButton: function (caption) {\n    return (0, _renderer2.default)(\"<div>\").text(caption);\n  },\n  _createGroupOperationButton: function (criteria) {\n    var _this2 = this;\n\n    var groupOperations = this._getGroupOperations(criteria);\n\n    var groupMenuItem = _utils2.default.getGroupMenuItem(criteria, groupOperations);\n\n    var caption = groupMenuItem.text;\n    var $operationButton = groupOperations && groupOperations.length < 2 ? this._createButton(caption).addClass(DISABLED_STATE_CLASS) : this._createButtonWithMenu({\n      caption: caption,\n      menu: {\n        items: groupOperations,\n        displayExpr: \"text\",\n        keyExpr: \"value\",\n        onItemClick: function (e) {\n          if (groupMenuItem !== e.itemData) {\n            _utils2.default.setGroupValue(criteria, e.itemData.value);\n\n            $operationButton.html(e.itemData.text);\n            groupMenuItem = e.itemData;\n\n            _this2._updateFilter();\n          }\n        },\n        onContentReady: function (e) {\n          e.component.selectItem(groupMenuItem);\n        },\n        cssClass: FILTER_BUILDER_GROUP_OPERATIONS_CLASS\n      }\n    });\n    return $operationButton.addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_GROUP_OPERATION_CLASS).attr(\"tabindex\", 0);\n  },\n  _createButtonWithMenu: function (options) {\n    var that = this;\n\n    var removeMenu = function () {\n      that.$element().find(\".\" + ACTIVE_CLASS).removeClass(ACTIVE_CLASS);\n      that.$element().find(\".dx-overlay .dx-treeview\").remove();\n      that.$element().find(\".dx-overlay\").remove();\n    };\n\n    var rtlEnabled = this.option(\"rtlEnabled\");\n\n    var menuOnItemClickWrapper = function (handler) {\n      return function (e) {\n        handler(e);\n\n        if (\"dxclick\" === e.event.type) {\n          removeMenu();\n        }\n      };\n    };\n\n    var position = rtlEnabled ? \"right\" : \"left\";\n\n    var $button = this._createButton(options.caption);\n\n    (0, _extend.extend)(options.menu, {\n      focusStateEnabled: true,\n      selectionMode: \"single\",\n      onItemClick: menuOnItemClickWrapper(options.menu.onItemClick),\n      onHiding: function (e) {\n        $button.removeClass(ACTIVE_CLASS);\n      },\n      position: {\n        my: position + \" top\",\n        at: position + \" bottom\",\n        offset: \"0 1\",\n        of: $button,\n        collision: \"flip\"\n      },\n      animation: null,\n      onHidden: function () {\n        removeMenu();\n      },\n      cssClass: FILTER_BUILDER_OVERLAY_CLASS + \" \" + options.menu.cssClass,\n      rtlEnabled: rtlEnabled\n    });\n    options.popup = {\n      onShown: function (info) {\n        var treeViewElement = (0, _renderer2.default)(info.component.content()).find(\".dx-treeview\");\n        var treeView = treeViewElement.dxTreeView(\"instance\");\n\n        _events_engine2.default.on(treeViewElement, \"keyup keydown\", function (e) {\n          var keyName = (0, _utils4.normalizeKeyName)(e);\n\n          if (\"keydown\" === e.type && keyName === TAB_KEY || \"keyup\" === e.type && (keyName === ESCAPE_KEY || keyName === ENTER_KEY)) {\n            info.component.hide();\n\n            _events_engine2.default.trigger(options.menu.position.of, \"focus\");\n          }\n        });\n\n        treeView.focus();\n        treeView.option(\"focusedElement\", null);\n      }\n    };\n\n    this._subscribeOnClickAndEnterKey($button, function () {\n      removeMenu();\n\n      that._createPopupWithTreeView(options, that.$element());\n\n      $button.addClass(ACTIVE_CLASS);\n    });\n\n    return $button;\n  },\n  _hasValueButton: function (condition) {\n    var customOperation = _utils2.default.getCustomOperation(this._customOperations, condition[1]);\n\n    return customOperation ? false !== customOperation.hasValue : null !== condition[2];\n  },\n  _createOperationButtonWithMenu: function (condition, field) {\n    var _this3 = this;\n\n    var that = this;\n\n    var availableOperations = _utils2.default.getAvailableOperations(field, this.option(\"filterOperationDescriptions\"), this._customOperations);\n\n    var currentOperation = _utils2.default.getOperationFromAvailable(_utils2.default.getOperationValue(condition), availableOperations);\n\n    var $operationButton = this._createButtonWithMenu({\n      caption: currentOperation.text,\n      menu: {\n        items: availableOperations,\n        displayExpr: \"text\",\n        onItemRendered: function (e) {\n          e.itemData.isCustom && (0, _renderer2.default)(e.itemElement).addClass(FILTER_BUILDER_MENU_CUSTOM_OPERATION_CLASS);\n        },\n        onContentReady: function (e) {\n          e.component.selectItem(currentOperation);\n        },\n        onItemClick: function (e) {\n          if (currentOperation !== e.itemData) {\n            currentOperation = e.itemData;\n\n            _utils2.default.updateConditionByOperation(condition, currentOperation.value, that._customOperations);\n\n            var $valueButton = $operationButton.siblings().filter(\".\" + FILTER_BUILDER_ITEM_VALUE_CLASS);\n\n            if (that._hasValueButton(condition)) {\n              if (0 !== $valueButton.length) {\n                $valueButton.remove();\n              }\n\n              that._createValueButton(condition, field).appendTo($operationButton.parent());\n            } else {\n              $valueButton.remove();\n            }\n\n            $operationButton.html(currentOperation.text);\n\n            _this3._updateFilter();\n          }\n        },\n        cssClass: FILTER_BUILDER_FILTER_OPERATIONS_CLASS\n      }\n    }).addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_ITEM_OPERATION_CLASS).attr(\"tabindex\", 0);\n\n    return $operationButton;\n  },\n  _createOperationAndValueButtons: function (condition, field, $item) {\n    this._createOperationButtonWithMenu(condition, field).appendTo($item);\n\n    if (this._hasValueButton(condition)) {\n      this._createValueButton(condition, field).appendTo($item);\n    }\n  },\n  _createFieldButtonWithMenu: function (fields, condition, field) {\n    var _this4 = this;\n\n    var that = this;\n    var allowHierarchicalFields = this.option(\"allowHierarchicalFields\");\n\n    var items = _utils2.default.getItems(fields, allowHierarchicalFields);\n\n    var item = _utils2.default.getField(field.name || field.dataField, items);\n\n    var getFullCaption = function (item, items) {\n      return allowHierarchicalFields ? _utils2.default.getCaptionWithParents(item, items) : item.caption;\n    };\n\n    var $fieldButton = this._createButtonWithMenu({\n      caption: getFullCaption(item, items),\n      menu: {\n        items: items,\n        dataStructure: \"plain\",\n        keyExpr: \"id\",\n        parentId: \"parentId\",\n        displayExpr: \"caption\",\n        onItemClick: function (e) {\n          if (item !== e.itemData) {\n            item = e.itemData;\n            condition[0] = item.name || item.dataField;\n            condition[2] = \"object\" === item.dataType ? null : \"\";\n\n            _utils2.default.updateConditionByOperation(condition, _utils2.default.getDefaultOperation(item), that._customOperations);\n\n            $fieldButton.siblings().filter(\".\" + FILTER_BUILDER_ITEM_TEXT_CLASS).remove();\n\n            that._createOperationAndValueButtons(condition, item, $fieldButton.parent());\n\n            var caption = getFullCaption(item, e.component.option(\"items\"));\n            $fieldButton.html(caption);\n\n            _this4._updateFilter();\n          }\n        },\n        onContentReady: function (e) {\n          e.component.selectItem(item);\n        },\n        cssClass: FILTER_BUILDER_FIELDS_CLASS\n      }\n    }).addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_ITEM_FIELD_CLASS).attr(\"tabindex\", 0);\n\n    return $fieldButton;\n  },\n  _createConditionItem: function (condition, parent) {\n    var _this5 = this;\n\n    var $item = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_ITEM_CLASS);\n\n    var fields = this._getNormalizedFields();\n\n    var field = _utils2.default.getField(condition[0], fields);\n\n    this._createRemoveButton(function () {\n      _utils2.default.removeItem(parent, condition);\n\n      var isSingleChild = 1 === $item.parent().children().length;\n\n      if (isSingleChild) {\n        $item.parent().remove();\n      } else {\n        $item.remove();\n      }\n\n      _this5._updateFilter();\n    }).appendTo($item);\n\n    this._createFieldButtonWithMenu(fields, condition, field).appendTo($item);\n\n    this._createOperationAndValueButtons(condition, field, $item);\n\n    return $item;\n  },\n  _getGroupOperations: function (criteria) {\n    var groupOperations = this.option(\"groupOperations\");\n    var groupOperationDescriptions = this.option(\"groupOperationDescriptions\");\n\n    if (!groupOperations || !groupOperations.length) {\n      groupOperations = [_utils2.default.getGroupValue(criteria).replace(\"!\", \"not\")];\n    }\n\n    return groupOperations.map(function (operation) {\n      return {\n        text: groupOperationDescriptions[operation],\n        value: OPERATORS[operation]\n      };\n    });\n  },\n  _createRemoveButton: function (handler) {\n    var $removeButton = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_IMAGE_CLASS).addClass(FILTER_BUILDER_IMAGE_REMOVE_CLASS).addClass(FILTER_BUILDER_ACTION_CLASS).attr(\"tabindex\", 0);\n\n    this._subscribeOnClickAndEnterKey($removeButton, handler);\n\n    return $removeButton;\n  },\n  _createAddButton: function (addGroupHandler, addConditionHandler, groupLevel) {\n    var $button;\n    var maxGroupLevel = this.option(\"maxGroupLevel\");\n\n    if ((0, _type.isDefined)(maxGroupLevel) && groupLevel >= maxGroupLevel) {\n      $button = this._createButton();\n\n      this._subscribeOnClickAndEnterKey($button, addConditionHandler);\n    } else {\n      $button = this._createButtonWithMenu({\n        menu: {\n          items: [{\n            caption: _message2.default.format(\"dxFilterBuilder-addCondition\"),\n            click: addConditionHandler\n          }, {\n            caption: _message2.default.format(\"dxFilterBuilder-addGroup\"),\n            click: addGroupHandler\n          }],\n          displayExpr: \"caption\",\n          onItemClick: function (e) {\n            e.itemData.click();\n          },\n          cssClass: FILTER_BUILDER_ADD_CONDITION_CLASS\n        }\n      });\n    }\n\n    return $button.addClass(FILTER_BUILDER_IMAGE_CLASS).addClass(FILTER_BUILDER_IMAGE_ADD_CLASS).addClass(FILTER_BUILDER_ACTION_CLASS).attr(\"tabindex\", 0);\n  },\n  _createValueText: function (item, field, $container) {\n    var that = this;\n    var $text = (0, _renderer2.default)(\"<div>\").html(\"&nbsp;\").addClass(FILTER_BUILDER_ITEM_VALUE_TEXT_CLASS).attr(\"tabindex\", 0).appendTo($container);\n    var value = item[2];\n\n    var customOperation = _utils2.default.getCustomOperation(that._customOperations, item[1]);\n\n    if (!customOperation && field.lookup) {\n      _utils2.default.getCurrentLookupValueText(field, value, function (result) {\n        renderValueText($text, result);\n      });\n    } else {\n      _deferred2.default.when(_utils2.default.getCurrentValueText(field, value, customOperation)).done(function (result) {\n        renderValueText($text, result, customOperation);\n      });\n    }\n\n    that._subscribeOnClickAndEnterKey($text, function (e) {\n      if (\"keyup\" === e.type) {\n        e.stopPropagation();\n      }\n\n      that._createValueEditorWithEvents(item, field, $container);\n    });\n\n    return $text;\n  },\n  _updateConditionValue: function (item, value, callback) {\n    var areValuesDifferent = item[2] !== value;\n\n    if (areValuesDifferent) {\n      item[2] = value;\n    }\n\n    callback();\n\n    this._updateFilter();\n  },\n  _addDocumentKeyUp: function ($editor, handler) {\n    var isComposing = false;\n    var hasCompositionJustEnded = false;\n\n    var document = _dom_adapter2.default.getDocument();\n\n    var documentKeyUpHandler = function (e) {\n      if (isComposing || hasCompositionJustEnded) {\n        hasCompositionJustEnded = false;\n        return;\n      }\n\n      handler(e);\n    };\n\n    _events_engine2.default.on(document, \"keyup\", documentKeyUpHandler);\n\n    var input = $editor.find(\"input\");\n\n    _events_engine2.default.on(input, \"compositionstart\", function () {\n      isComposing = true;\n    });\n\n    _events_engine2.default.on(input, \"compositionend\", function () {\n      isComposing = false;\n      hasCompositionJustEnded = true;\n    });\n\n    _events_engine2.default.on(input, \"keydown\", function (event) {\n      if (229 !== event.which) {\n        hasCompositionJustEnded = false;\n      }\n    });\n\n    this._documentKeyUpHandler = documentKeyUpHandler;\n  },\n  _addDocumentClick: function ($editor, closeEditorFunc) {\n    var _this6 = this;\n\n    var document = _dom_adapter2.default.getDocument();\n\n    var documentClickHandler = function (e) {\n      if (!_this6._isFocusOnEditorParts($editor, e.target)) {\n        _events_engine2.default.trigger($editor.find(\"input\"), \"change\");\n\n        closeEditorFunc();\n      }\n    };\n\n    _events_engine2.default.on(document, \"dxpointerdown\", documentClickHandler);\n\n    this._documentClickHandler = documentClickHandler;\n  },\n  _isFocusOnEditorParts: function ($editor, target) {\n    var activeElement = target || _dom_adapter2.default.getActiveElement();\n\n    return (0, _renderer2.default)(activeElement).closest($editor.children()).length || (0, _renderer2.default)(activeElement).closest(\".dx-dropdowneditor-overlay\").length;\n  },\n  _removeEvents: function () {\n    var document = _dom_adapter2.default.getDocument();\n\n    (0, _type.isDefined)(this._documentKeyUpHandler) && _events_engine2.default.off(document, \"keyup\", this._documentKeyUpHandler);\n    (0, _type.isDefined)(this._documentClickHandler) && _events_engine2.default.off(document, \"dxpointerdown\", this._documentClickHandler);\n  },\n  _dispose: function () {\n    this._removeEvents();\n\n    this.callBase();\n  },\n  _createValueEditorWithEvents: function (item, field, $container) {\n    var _this7 = this;\n\n    var value = item[2];\n\n    var createValueText = function () {\n      $container.empty();\n\n      _this7._removeEvents();\n\n      return _this7._createValueText(item, field, $container);\n    };\n\n    var closeEditor = function () {\n      _this7._updateConditionValue(item, value, function () {\n        createValueText();\n      });\n    };\n\n    var options = {\n      value: \"\" === value ? null : value,\n      filterOperation: _utils2.default.getOperationValue(item),\n      setValue: function (data) {\n        value = null === data ? \"\" : data;\n      },\n      closeEditor: closeEditor,\n      text: $container.text()\n    };\n    $container.empty();\n\n    var $editor = this._createValueEditor($container, field, options);\n\n    _events_engine2.default.trigger($editor.find(\"input\").not(\":hidden\").eq(0), \"focus\");\n\n    this._removeEvents();\n\n    this._addDocumentClick($editor, closeEditor);\n\n    this._addDocumentKeyUp($editor, function (e) {\n      var keyName = (0, _utils4.normalizeKeyName)(e);\n\n      if (keyName === TAB_KEY) {\n        if (_this7._isFocusOnEditorParts($editor)) {\n          return;\n        }\n\n        _this7._updateConditionValue(item, value, function () {\n          createValueText();\n\n          if (e.shiftKey) {\n            _events_engine2.default.trigger($container.prev(), \"focus\");\n          }\n        });\n      }\n\n      if (keyName === ESCAPE_KEY) {\n        _events_engine2.default.trigger(createValueText(), \"focus\");\n      }\n\n      if (keyName === ENTER_KEY) {\n        _this7._updateConditionValue(item, value, function () {\n          _events_engine2.default.trigger(createValueText(), \"focus\");\n        });\n      }\n    });\n\n    this._fireContentReadyAction();\n  },\n  _createValueButton: function (item, field) {\n    var $valueButton = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_ITEM_VALUE_CLASS);\n\n    this._createValueText(item, field, $valueButton);\n\n    return $valueButton;\n  },\n  _createValueEditor: function ($container, field, options) {\n    var $editor = (0, _renderer2.default)(\"<div>\").attr(\"tabindex\", 0).appendTo($container);\n\n    var customOperation = _utils2.default.getCustomOperation(this._customOperations, options.filterOperation);\n\n    var editorTemplate = customOperation && customOperation.editorTemplate ? customOperation.editorTemplate : field.editorTemplate;\n\n    if (editorTemplate) {\n      var template = this._getTemplate(editorTemplate);\n\n      template.render({\n        model: (0, _extend.extend)({\n          field: field\n        }, options),\n        container: $editor\n      });\n    } else {\n      this._editorFactory.createEditor.call(this, $editor, (0, _extend.extend)({}, field, options, {\n        parentType: SOURCE\n      }));\n    }\n\n    return $editor;\n  },\n  _createPopupWithTreeView: function (options, $container) {\n    var that = this;\n    var $popup = (0, _renderer2.default)(\"<div>\").addClass(options.menu.cssClass).appendTo($container);\n\n    this._createComponent($popup, _popup2.default, {\n      onHiding: options.menu.onHiding,\n      onHidden: options.menu.onHidden,\n      rtlEnabled: options.menu.rtlEnabled,\n      position: options.menu.position,\n      animation: options.menu.animation,\n      contentTemplate: function (contentElement) {\n        var $menuContainer = (0, _renderer2.default)(\"<div>\").appendTo(contentElement);\n\n        that._createComponent($menuContainer, _tree_view2.default, options.menu);\n\n        this.repaint();\n      },\n      maxHeight: function () {\n        return (0, _utils3.getElementMaxHeightByWindow)(options.menu.position.of);\n      },\n      visible: true,\n      focusStateEnabled: false,\n      closeOnTargetScroll: this.option(\"closePopupOnTargetScroll\"),\n      closeOnOutsideClick: true,\n      onShown: options.popup.onShown,\n      shading: false,\n      width: \"auto\",\n      height: \"auto\",\n      showTitle: false\n    });\n  },\n  _subscribeOnClickAndEnterKey: function ($button, handler) {\n    _events_engine2.default.on($button, \"dxclick\", handler);\n\n    _events_engine2.default.on($button, \"keyup\", function (e) {\n      if ((0, _utils4.normalizeKeyName)(e) === ENTER_KEY) {\n        handler(e);\n      }\n    });\n  }\n});\n\n(0, _component_registrator2.default)(\"dxFilterBuilder\", FilterBuilder);\nmodule.exports = FilterBuilder;\nmodule.exports.renderValueText = renderValueText;","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/ticketSystem/frontend/node_modules/devextreme/ui/filter_builder/filter_builder.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_dom_adapter","_dom_adapter2","_class","_class2","_events_engine","_events_engine2","_ui","_ui2","_component_registrator","_component_registrator2","_extend","_message","_message2","_utils","_utils2","_deferred","_deferred2","_type","_tree_view","_tree_view2","_popup","_popup2","_utils3","_ui3","_ui4","_utils4","obj","__esModule","FILTER_BUILDER_CLASS","FILTER_BUILDER_GROUP_CLASS","FILTER_BUILDER_GROUP_ITEM_CLASS","FILTER_BUILDER_GROUP_CONTENT_CLASS","FILTER_BUILDER_GROUP_OPERATIONS_CLASS","FILTER_BUILDER_GROUP_OPERATION_CLASS","FILTER_BUILDER_ACTION_CLASS","FILTER_BUILDER_IMAGE_CLASS","FILTER_BUILDER_IMAGE_ADD_CLASS","FILTER_BUILDER_IMAGE_REMOVE_CLASS","FILTER_BUILDER_ITEM_TEXT_CLASS","FILTER_BUILDER_ITEM_TEXT_PART_CLASS","FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS","FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS","FILTER_BUILDER_ITEM_FIELD_CLASS","FILTER_BUILDER_ITEM_OPERATION_CLASS","FILTER_BUILDER_ITEM_VALUE_CLASS","FILTER_BUILDER_ITEM_VALUE_TEXT_CLASS","FILTER_BUILDER_OVERLAY_CLASS","FILTER_BUILDER_FILTER_OPERATIONS_CLASS","FILTER_BUILDER_FIELDS_CLASS","FILTER_BUILDER_ADD_CONDITION_CLASS","ACTIVE_CLASS","FILTER_BUILDER_MENU_CUSTOM_OPERATION_CLASS","SOURCE","DISABLED_STATE_CLASS","TAB_KEY","ENTER_KEY","ESCAPE_KEY","ACTIONS","name","config","excludeValidators","category","OPERATORS","and","or","notAnd","notOr","EditorFactory","default","inherit","renderValueText","$container","value","customOperation","Array","isArray","lastItemIndex","length","empty","forEach","t","i","addClass","text","appendTo","valueSeparator","format","FilterBuilder","_getDefaultOptions","extend","callBase","onEditorPreparing","onEditorPrepared","onValueChanged","fields","defaultGroupOperation","groupOperations","maxGroupLevel","allowHierarchicalFields","groupOperationDescriptions","customOperations","closePopupOnTargetScroll","filterOperationDescriptions","between","equal","notEqual","lessThan","lessThanOrEqual","greaterThan","greaterThanOrEqual","startsWith","contains","notContains","endsWith","isBlank","isNotBlank","_optionChanged","args","_initActions","_initCustomOperations","_invalidate","previousValue","disableInvalidateForValue","_disableInvalidateForValue","_initModel","executeAction","getFilterExpression","_getNormalizedFields","_model","getNormalizedFilter","_customOperations","getNormalizedFields","option","_updateFilter","normalizedValue","oldValue","_getModel","JSON","stringify","_fireContentReadyAction","_init","_initEditorFactory","_editorFactory","getMergedOperations","convertToInnerStructure","that","_actions","action","_createActionByOption","actionName","options","_initMarkup","$element","_createGroupElementByCriteria","_createConditionElement","condition","parent","append","_createConditionItem","criteria","groupLevel","arguments","$group","_createGroupElement","$groupContent","find","groupCriteria","getGroupCriteria","innerCriteria","isGroup","isCondition","_this","$groupItem","_createRemoveButton","removeItem","remove","_createGroupOperationButton","_createAddButton","newGroup","createEmptyGroup","addItem","field","newCondition","createCondition","_createButton","caption","_this2","_getGroupOperations","groupMenuItem","getGroupMenuItem","$operationButton","_createButtonWithMenu","menu","items","displayExpr","keyExpr","onItemClick","e","itemData","setGroupValue","html","onContentReady","component","selectItem","cssClass","attr","removeMenu","removeClass","rtlEnabled","menuOnItemClickWrapper","handler","event","type","position","$button","focusStateEnabled","selectionMode","onHiding","my","at","offset","of","collision","animation","onHidden","popup","onShown","info","treeViewElement","content","treeView","dxTreeView","on","keyName","normalizeKeyName","hide","trigger","focus","_subscribeOnClickAndEnterKey","_createPopupWithTreeView","_hasValueButton","getCustomOperation","hasValue","_createOperationButtonWithMenu","_this3","availableOperations","getAvailableOperations","currentOperation","getOperationFromAvailable","getOperationValue","onItemRendered","isCustom","itemElement","updateConditionByOperation","$valueButton","siblings","filter","_createValueButton","_createOperationAndValueButtons","$item","_createFieldButtonWithMenu","_this4","getItems","item","getField","dataField","getFullCaption","getCaptionWithParents","$fieldButton","dataStructure","parentId","dataType","getDefaultOperation","_this5","isSingleChild","children","getGroupValue","replace","map","operation","$removeButton","addGroupHandler","addConditionHandler","isDefined","click","_createValueText","$text","lookup","getCurrentLookupValueText","result","when","getCurrentValueText","done","stopPropagation","_createValueEditorWithEvents","_updateConditionValue","callback","areValuesDifferent","_addDocumentKeyUp","$editor","isComposing","hasCompositionJustEnded","document","getDocument","documentKeyUpHandler","input","which","_documentKeyUpHandler","_addDocumentClick","closeEditorFunc","_this6","documentClickHandler","_isFocusOnEditorParts","target","_documentClickHandler","activeElement","getActiveElement","closest","_removeEvents","off","_dispose","_this7","createValueText","closeEditor","filterOperation","setValue","data","_createValueEditor","not","eq","shiftKey","prev","editorTemplate","template","_getTemplate","render","model","container","createEditor","call","parentType","$popup","_createComponent","contentTemplate","contentElement","$menuContainer","repaint","maxHeight","getElementMaxHeightByWindow","visible","closeOnTargetScroll","closeOnOutsideClick","shading","width","height","showTitle","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/filter_builder/filter_builder.js)\r\n * Version: 20.1.7\r\n * Build date: Tue Aug 25 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _dom_adapter = require(\"../../core/dom_adapter\");\r\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\r\nvar _class = require(\"../../core/class\");\r\nvar _class2 = _interopRequireDefault(_class);\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _ui = require(\"../widget/ui.widget\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _component_registrator = require(\"../../core/component_registrator\");\r\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _utils = require(\"./utils\");\r\nvar _utils2 = _interopRequireDefault(_utils);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _deferred2 = _interopRequireDefault(_deferred);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _tree_view = require(\"../tree_view\");\r\nvar _tree_view2 = _interopRequireDefault(_tree_view);\r\nvar _popup = require(\"../popup\");\r\nvar _popup2 = _interopRequireDefault(_popup);\r\nvar _utils3 = require(\"../overlay/utils\");\r\nvar _ui3 = require(\"../shared/ui.editor_factory_mixin\");\r\nvar _ui4 = _interopRequireDefault(_ui3);\r\nvar _utils4 = require(\"../../events/utils\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar FILTER_BUILDER_CLASS = \"dx-filterbuilder\";\r\nvar FILTER_BUILDER_GROUP_CLASS = FILTER_BUILDER_CLASS + \"-group\";\r\nvar FILTER_BUILDER_GROUP_ITEM_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-item\";\r\nvar FILTER_BUILDER_GROUP_CONTENT_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-content\";\r\nvar FILTER_BUILDER_GROUP_OPERATIONS_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-operations\";\r\nvar FILTER_BUILDER_GROUP_OPERATION_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-operation\";\r\nvar FILTER_BUILDER_ACTION_CLASS = FILTER_BUILDER_CLASS + \"-action\";\r\nvar FILTER_BUILDER_IMAGE_CLASS = FILTER_BUILDER_ACTION_CLASS + \"-icon\";\r\nvar FILTER_BUILDER_IMAGE_ADD_CLASS = \"dx-icon-plus\";\r\nvar FILTER_BUILDER_IMAGE_REMOVE_CLASS = \"dx-icon-remove\";\r\nvar FILTER_BUILDER_ITEM_TEXT_CLASS = FILTER_BUILDER_CLASS + \"-text\";\r\nvar FILTER_BUILDER_ITEM_TEXT_PART_CLASS = FILTER_BUILDER_ITEM_TEXT_CLASS + \"-part\";\r\nvar FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS = FILTER_BUILDER_ITEM_TEXT_CLASS + \"-separator\";\r\nvar FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS = FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS + \"-empty\";\r\nvar FILTER_BUILDER_ITEM_FIELD_CLASS = FILTER_BUILDER_CLASS + \"-item-field\";\r\nvar FILTER_BUILDER_ITEM_OPERATION_CLASS = FILTER_BUILDER_CLASS + \"-item-operation\";\r\nvar FILTER_BUILDER_ITEM_VALUE_CLASS = FILTER_BUILDER_CLASS + \"-item-value\";\r\nvar FILTER_BUILDER_ITEM_VALUE_TEXT_CLASS = FILTER_BUILDER_CLASS + \"-item-value-text\";\r\nvar FILTER_BUILDER_OVERLAY_CLASS = FILTER_BUILDER_CLASS + \"-overlay\";\r\nvar FILTER_BUILDER_FILTER_OPERATIONS_CLASS = FILTER_BUILDER_CLASS + \"-operations\";\r\nvar FILTER_BUILDER_FIELDS_CLASS = FILTER_BUILDER_CLASS + \"-fields\";\r\nvar FILTER_BUILDER_ADD_CONDITION_CLASS = FILTER_BUILDER_CLASS + \"-add-condition\";\r\nvar ACTIVE_CLASS = \"dx-state-active\";\r\nvar FILTER_BUILDER_MENU_CUSTOM_OPERATION_CLASS = FILTER_BUILDER_CLASS + \"-menu-custom-operation\";\r\nvar SOURCE = \"filterBuilder\";\r\nvar DISABLED_STATE_CLASS = \"dx-state-disabled\";\r\nvar TAB_KEY = \"tab\";\r\nvar ENTER_KEY = \"enter\";\r\nvar ESCAPE_KEY = \"escape\";\r\nvar ACTIONS = [{\r\n    name: \"onEditorPreparing\",\r\n    config: {\r\n        excludeValidators: [\"disabled\", \"readOnly\"],\r\n        category: \"rendering\"\r\n    }\r\n}, {\r\n    name: \"onEditorPrepared\",\r\n    config: {\r\n        excludeValidators: [\"disabled\", \"readOnly\"],\r\n        category: \"rendering\"\r\n    }\r\n}, {\r\n    name: \"onValueChanged\",\r\n    config: {\r\n        excludeValidators: [\"disabled\", \"readOnly\"]\r\n    }\r\n}];\r\nvar OPERATORS = {\r\n    and: \"and\",\r\n    or: \"or\",\r\n    notAnd: \"!and\",\r\n    notOr: \"!or\"\r\n};\r\nvar EditorFactory = _class2.default.inherit(_ui4.default);\r\nvar renderValueText = function($container, value, customOperation) {\r\n    if (Array.isArray(value)) {\r\n        var lastItemIndex = value.length - 1;\r\n        $container.empty();\r\n        value.forEach(function(t, i) {\r\n            (0, _renderer2.default)(\"<span>\").addClass(FILTER_BUILDER_ITEM_TEXT_PART_CLASS).text(t).appendTo($container);\r\n            if (i !== lastItemIndex) {\r\n                (0, _renderer2.default)(\"<span>\").addClass(FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS).text(customOperation && customOperation.valueSeparator ? customOperation.valueSeparator : \"|\").addClass(FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS).appendTo($container)\r\n            }\r\n        })\r\n    } else {\r\n        if (value) {\r\n            $container.text(value)\r\n        } else {\r\n            $container.text(_message2.default.format(\"dxFilterBuilder-enterValueText\"))\r\n        }\r\n    }\r\n};\r\nvar FilterBuilder = _ui2.default.inherit({\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            onEditorPreparing: null,\r\n            onEditorPrepared: null,\r\n            onValueChanged: null,\r\n            fields: [],\r\n            defaultGroupOperation: \"and\",\r\n            groupOperations: [\"and\", \"or\", \"notAnd\", \"notOr\"],\r\n            maxGroupLevel: void 0,\r\n            value: null,\r\n            allowHierarchicalFields: false,\r\n            groupOperationDescriptions: {\r\n                and: _message2.default.format(\"dxFilterBuilder-and\"),\r\n                or: _message2.default.format(\"dxFilterBuilder-or\"),\r\n                notAnd: _message2.default.format(\"dxFilterBuilder-notAnd\"),\r\n                notOr: _message2.default.format(\"dxFilterBuilder-notOr\")\r\n            },\r\n            customOperations: [],\r\n            closePopupOnTargetScroll: true,\r\n            filterOperationDescriptions: {\r\n                between: _message2.default.format(\"dxFilterBuilder-filterOperationBetween\"),\r\n                equal: _message2.default.format(\"dxFilterBuilder-filterOperationEquals\"),\r\n                notEqual: _message2.default.format(\"dxFilterBuilder-filterOperationNotEquals\"),\r\n                lessThan: _message2.default.format(\"dxFilterBuilder-filterOperationLess\"),\r\n                lessThanOrEqual: _message2.default.format(\"dxFilterBuilder-filterOperationLessOrEquals\"),\r\n                greaterThan: _message2.default.format(\"dxFilterBuilder-filterOperationGreater\"),\r\n                greaterThanOrEqual: _message2.default.format(\"dxFilterBuilder-filterOperationGreaterOrEquals\"),\r\n                startsWith: _message2.default.format(\"dxFilterBuilder-filterOperationStartsWith\"),\r\n                contains: _message2.default.format(\"dxFilterBuilder-filterOperationContains\"),\r\n                notContains: _message2.default.format(\"dxFilterBuilder-filterOperationNotContains\"),\r\n                endsWith: _message2.default.format(\"dxFilterBuilder-filterOperationEndsWith\"),\r\n                isBlank: _message2.default.format(\"dxFilterBuilder-filterOperationIsBlank\"),\r\n                isNotBlank: _message2.default.format(\"dxFilterBuilder-filterOperationIsNotBlank\")\r\n            }\r\n        })\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"closePopupOnTargetScroll\":\r\n                break;\r\n            case \"onEditorPreparing\":\r\n            case \"onEditorPrepared\":\r\n            case \"onValueChanged\":\r\n                this._initActions();\r\n                break;\r\n            case \"customOperations\":\r\n                this._initCustomOperations();\r\n                this._invalidate();\r\n                break;\r\n            case \"fields\":\r\n            case \"defaultGroupOperation\":\r\n            case \"maxGroupLevel\":\r\n            case \"groupOperations\":\r\n            case \"allowHierarchicalFields\":\r\n            case \"groupOperationDescriptions\":\r\n            case \"filterOperationDescriptions\":\r\n                this._invalidate();\r\n                break;\r\n            case \"value\":\r\n                if (args.value !== args.previousValue) {\r\n                    var disableInvalidateForValue = this._disableInvalidateForValue;\r\n                    if (!disableInvalidateForValue) {\r\n                        this._initModel();\r\n                        this._invalidate()\r\n                    }\r\n                    this._disableInvalidateForValue = false;\r\n                    this.executeAction(\"onValueChanged\", {\r\n                        value: args.value,\r\n                        previousValue: args.previousValue\r\n                    });\r\n                    this._disableInvalidateForValue = disableInvalidateForValue\r\n                }\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    getFilterExpression: function() {\r\n        var fields = this._getNormalizedFields();\r\n        var value = (0, _extend.extend)(true, [], this._model);\r\n        return _utils2.default.getFilterExpression(_utils2.default.getNormalizedFilter(value), fields, this._customOperations, SOURCE)\r\n    },\r\n    _getNormalizedFields: function() {\r\n        return _utils2.default.getNormalizedFields(this.option(\"fields\"))\r\n    },\r\n    _updateFilter: function() {\r\n        this._disableInvalidateForValue = true;\r\n        var value = (0, _extend.extend)(true, [], this._model);\r\n        var normalizedValue = _utils2.default.getNormalizedFilter(value);\r\n        var oldValue = _utils2.default.getNormalizedFilter(this._getModel(this.option(\"value\")));\r\n        if (JSON.stringify(oldValue) !== JSON.stringify(normalizedValue)) {\r\n            this.option(\"value\", normalizedValue)\r\n        }\r\n        this._disableInvalidateForValue = false;\r\n        this._fireContentReadyAction()\r\n    },\r\n    _init: function() {\r\n        this._initCustomOperations();\r\n        this._initModel();\r\n        this._initEditorFactory();\r\n        this._initActions();\r\n        this.callBase()\r\n    },\r\n    _initEditorFactory: function() {\r\n        this._editorFactory = new EditorFactory\r\n    },\r\n    _initCustomOperations: function() {\r\n        this._customOperations = _utils2.default.getMergedOperations(this.option(\"customOperations\"), this.option(\"filterOperationDescriptions.between\"), this)\r\n    },\r\n    _getModel: function(value) {\r\n        return _utils2.default.convertToInnerStructure(value, this._customOperations)\r\n    },\r\n    _initModel: function() {\r\n        this._model = this._getModel(this.option(\"value\"))\r\n    },\r\n    _initActions: function() {\r\n        var that = this;\r\n        that._actions = {};\r\n        ACTIONS.forEach(function(action) {\r\n            that._actions[action.name] = that._createActionByOption(action.name, action.config)\r\n        })\r\n    },\r\n    executeAction: function(actionName, options) {\r\n        var action = this._actions[actionName];\r\n        return action && action(options)\r\n    },\r\n    _initMarkup: function() {\r\n        this.$element().addClass(FILTER_BUILDER_CLASS);\r\n        this.callBase();\r\n        this._createGroupElementByCriteria(this._model).appendTo(this.$element())\r\n    },\r\n    _createConditionElement: function(condition, parent) {\r\n        return (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_CLASS).append(this._createConditionItem(condition, parent))\r\n    },\r\n    _createGroupElementByCriteria: function(criteria, parent) {\r\n        var groupLevel = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0;\r\n        var $group = this._createGroupElement(criteria, parent, groupLevel);\r\n        var $groupContent = $group.find(\".\" + FILTER_BUILDER_GROUP_CONTENT_CLASS);\r\n        var groupCriteria = _utils2.default.getGroupCriteria(criteria);\r\n        for (var i = 0; i < groupCriteria.length; i++) {\r\n            var innerCriteria = groupCriteria[i];\r\n            if (_utils2.default.isGroup(innerCriteria)) {\r\n                this._createGroupElementByCriteria(innerCriteria, groupCriteria, groupLevel + 1).appendTo($groupContent)\r\n            } else {\r\n                if (_utils2.default.isCondition(innerCriteria)) {\r\n                    this._createConditionElement(innerCriteria, groupCriteria).appendTo($groupContent)\r\n                }\r\n            }\r\n        }\r\n        return $group\r\n    },\r\n    _createGroupElement: function(criteria, parent, groupLevel) {\r\n        var _this = this;\r\n        var $groupItem = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_ITEM_CLASS);\r\n        var $groupContent = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_CONTENT_CLASS);\r\n        var $group = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_CLASS).append($groupItem).append($groupContent);\r\n        if (null != parent) {\r\n            this._createRemoveButton(function() {\r\n                _utils2.default.removeItem(parent, criteria);\r\n                $group.remove();\r\n                _this._updateFilter()\r\n            }).appendTo($groupItem)\r\n        }\r\n        this._createGroupOperationButton(criteria).appendTo($groupItem);\r\n        this._createAddButton(function() {\r\n            var newGroup = _utils2.default.createEmptyGroup(_this.option(\"defaultGroupOperation\"));\r\n            _utils2.default.addItem(newGroup, criteria);\r\n            _this._createGroupElement(newGroup, criteria, groupLevel + 1).appendTo($groupContent);\r\n            _this._updateFilter()\r\n        }, function() {\r\n            var field = _this.option(\"fields\")[0];\r\n            var newCondition = _utils2.default.createCondition(field, _this._customOperations);\r\n            _utils2.default.addItem(newCondition, criteria);\r\n            _this._createConditionElement(newCondition, criteria).appendTo($groupContent);\r\n            _this._updateFilter()\r\n        }, groupLevel).appendTo($groupItem);\r\n        return $group\r\n    },\r\n    _createButton: function(caption) {\r\n        return (0, _renderer2.default)(\"<div>\").text(caption)\r\n    },\r\n    _createGroupOperationButton: function(criteria) {\r\n        var _this2 = this;\r\n        var groupOperations = this._getGroupOperations(criteria);\r\n        var groupMenuItem = _utils2.default.getGroupMenuItem(criteria, groupOperations);\r\n        var caption = groupMenuItem.text;\r\n        var $operationButton = groupOperations && groupOperations.length < 2 ? this._createButton(caption).addClass(DISABLED_STATE_CLASS) : this._createButtonWithMenu({\r\n            caption: caption,\r\n            menu: {\r\n                items: groupOperations,\r\n                displayExpr: \"text\",\r\n                keyExpr: \"value\",\r\n                onItemClick: function(e) {\r\n                    if (groupMenuItem !== e.itemData) {\r\n                        _utils2.default.setGroupValue(criteria, e.itemData.value);\r\n                        $operationButton.html(e.itemData.text);\r\n                        groupMenuItem = e.itemData;\r\n                        _this2._updateFilter()\r\n                    }\r\n                },\r\n                onContentReady: function(e) {\r\n                    e.component.selectItem(groupMenuItem)\r\n                },\r\n                cssClass: FILTER_BUILDER_GROUP_OPERATIONS_CLASS\r\n            }\r\n        });\r\n        return $operationButton.addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_GROUP_OPERATION_CLASS).attr(\"tabindex\", 0)\r\n    },\r\n    _createButtonWithMenu: function(options) {\r\n        var that = this;\r\n        var removeMenu = function() {\r\n            that.$element().find(\".\" + ACTIVE_CLASS).removeClass(ACTIVE_CLASS);\r\n            that.$element().find(\".dx-overlay .dx-treeview\").remove();\r\n            that.$element().find(\".dx-overlay\").remove()\r\n        };\r\n        var rtlEnabled = this.option(\"rtlEnabled\");\r\n        var menuOnItemClickWrapper = function(handler) {\r\n            return function(e) {\r\n                handler(e);\r\n                if (\"dxclick\" === e.event.type) {\r\n                    removeMenu()\r\n                }\r\n            }\r\n        };\r\n        var position = rtlEnabled ? \"right\" : \"left\";\r\n        var $button = this._createButton(options.caption);\r\n        (0, _extend.extend)(options.menu, {\r\n            focusStateEnabled: true,\r\n            selectionMode: \"single\",\r\n            onItemClick: menuOnItemClickWrapper(options.menu.onItemClick),\r\n            onHiding: function(e) {\r\n                $button.removeClass(ACTIVE_CLASS)\r\n            },\r\n            position: {\r\n                my: position + \" top\",\r\n                at: position + \" bottom\",\r\n                offset: \"0 1\",\r\n                of: $button,\r\n                collision: \"flip\"\r\n            },\r\n            animation: null,\r\n            onHidden: function() {\r\n                removeMenu()\r\n            },\r\n            cssClass: FILTER_BUILDER_OVERLAY_CLASS + \" \" + options.menu.cssClass,\r\n            rtlEnabled: rtlEnabled\r\n        });\r\n        options.popup = {\r\n            onShown: function(info) {\r\n                var treeViewElement = (0, _renderer2.default)(info.component.content()).find(\".dx-treeview\");\r\n                var treeView = treeViewElement.dxTreeView(\"instance\");\r\n                _events_engine2.default.on(treeViewElement, \"keyup keydown\", function(e) {\r\n                    var keyName = (0, _utils4.normalizeKeyName)(e);\r\n                    if (\"keydown\" === e.type && keyName === TAB_KEY || \"keyup\" === e.type && (keyName === ESCAPE_KEY || keyName === ENTER_KEY)) {\r\n                        info.component.hide();\r\n                        _events_engine2.default.trigger(options.menu.position.of, \"focus\")\r\n                    }\r\n                });\r\n                treeView.focus();\r\n                treeView.option(\"focusedElement\", null)\r\n            }\r\n        };\r\n        this._subscribeOnClickAndEnterKey($button, function() {\r\n            removeMenu();\r\n            that._createPopupWithTreeView(options, that.$element());\r\n            $button.addClass(ACTIVE_CLASS)\r\n        });\r\n        return $button\r\n    },\r\n    _hasValueButton: function(condition) {\r\n        var customOperation = _utils2.default.getCustomOperation(this._customOperations, condition[1]);\r\n        return customOperation ? false !== customOperation.hasValue : null !== condition[2]\r\n    },\r\n    _createOperationButtonWithMenu: function(condition, field) {\r\n        var _this3 = this;\r\n        var that = this;\r\n        var availableOperations = _utils2.default.getAvailableOperations(field, this.option(\"filterOperationDescriptions\"), this._customOperations);\r\n        var currentOperation = _utils2.default.getOperationFromAvailable(_utils2.default.getOperationValue(condition), availableOperations);\r\n        var $operationButton = this._createButtonWithMenu({\r\n            caption: currentOperation.text,\r\n            menu: {\r\n                items: availableOperations,\r\n                displayExpr: \"text\",\r\n                onItemRendered: function(e) {\r\n                    e.itemData.isCustom && (0, _renderer2.default)(e.itemElement).addClass(FILTER_BUILDER_MENU_CUSTOM_OPERATION_CLASS)\r\n                },\r\n                onContentReady: function(e) {\r\n                    e.component.selectItem(currentOperation)\r\n                },\r\n                onItemClick: function(e) {\r\n                    if (currentOperation !== e.itemData) {\r\n                        currentOperation = e.itemData;\r\n                        _utils2.default.updateConditionByOperation(condition, currentOperation.value, that._customOperations);\r\n                        var $valueButton = $operationButton.siblings().filter(\".\" + FILTER_BUILDER_ITEM_VALUE_CLASS);\r\n                        if (that._hasValueButton(condition)) {\r\n                            if (0 !== $valueButton.length) {\r\n                                $valueButton.remove()\r\n                            }\r\n                            that._createValueButton(condition, field).appendTo($operationButton.parent())\r\n                        } else {\r\n                            $valueButton.remove()\r\n                        }\r\n                        $operationButton.html(currentOperation.text);\r\n                        _this3._updateFilter()\r\n                    }\r\n                },\r\n                cssClass: FILTER_BUILDER_FILTER_OPERATIONS_CLASS\r\n            }\r\n        }).addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_ITEM_OPERATION_CLASS).attr(\"tabindex\", 0);\r\n        return $operationButton\r\n    },\r\n    _createOperationAndValueButtons: function(condition, field, $item) {\r\n        this._createOperationButtonWithMenu(condition, field).appendTo($item);\r\n        if (this._hasValueButton(condition)) {\r\n            this._createValueButton(condition, field).appendTo($item)\r\n        }\r\n    },\r\n    _createFieldButtonWithMenu: function(fields, condition, field) {\r\n        var _this4 = this;\r\n        var that = this;\r\n        var allowHierarchicalFields = this.option(\"allowHierarchicalFields\");\r\n        var items = _utils2.default.getItems(fields, allowHierarchicalFields);\r\n        var item = _utils2.default.getField(field.name || field.dataField, items);\r\n        var getFullCaption = function(item, items) {\r\n            return allowHierarchicalFields ? _utils2.default.getCaptionWithParents(item, items) : item.caption\r\n        };\r\n        var $fieldButton = this._createButtonWithMenu({\r\n            caption: getFullCaption(item, items),\r\n            menu: {\r\n                items: items,\r\n                dataStructure: \"plain\",\r\n                keyExpr: \"id\",\r\n                parentId: \"parentId\",\r\n                displayExpr: \"caption\",\r\n                onItemClick: function(e) {\r\n                    if (item !== e.itemData) {\r\n                        item = e.itemData;\r\n                        condition[0] = item.name || item.dataField;\r\n                        condition[2] = \"object\" === item.dataType ? null : \"\";\r\n                        _utils2.default.updateConditionByOperation(condition, _utils2.default.getDefaultOperation(item), that._customOperations);\r\n                        $fieldButton.siblings().filter(\".\" + FILTER_BUILDER_ITEM_TEXT_CLASS).remove();\r\n                        that._createOperationAndValueButtons(condition, item, $fieldButton.parent());\r\n                        var caption = getFullCaption(item, e.component.option(\"items\"));\r\n                        $fieldButton.html(caption);\r\n                        _this4._updateFilter()\r\n                    }\r\n                },\r\n                onContentReady: function(e) {\r\n                    e.component.selectItem(item)\r\n                },\r\n                cssClass: FILTER_BUILDER_FIELDS_CLASS\r\n            }\r\n        }).addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_ITEM_FIELD_CLASS).attr(\"tabindex\", 0);\r\n        return $fieldButton\r\n    },\r\n    _createConditionItem: function(condition, parent) {\r\n        var _this5 = this;\r\n        var $item = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_ITEM_CLASS);\r\n        var fields = this._getNormalizedFields();\r\n        var field = _utils2.default.getField(condition[0], fields);\r\n        this._createRemoveButton(function() {\r\n            _utils2.default.removeItem(parent, condition);\r\n            var isSingleChild = 1 === $item.parent().children().length;\r\n            if (isSingleChild) {\r\n                $item.parent().remove()\r\n            } else {\r\n                $item.remove()\r\n            }\r\n            _this5._updateFilter()\r\n        }).appendTo($item);\r\n        this._createFieldButtonWithMenu(fields, condition, field).appendTo($item);\r\n        this._createOperationAndValueButtons(condition, field, $item);\r\n        return $item\r\n    },\r\n    _getGroupOperations: function(criteria) {\r\n        var groupOperations = this.option(\"groupOperations\");\r\n        var groupOperationDescriptions = this.option(\"groupOperationDescriptions\");\r\n        if (!groupOperations || !groupOperations.length) {\r\n            groupOperations = [_utils2.default.getGroupValue(criteria).replace(\"!\", \"not\")]\r\n        }\r\n        return groupOperations.map(function(operation) {\r\n            return {\r\n                text: groupOperationDescriptions[operation],\r\n                value: OPERATORS[operation]\r\n            }\r\n        })\r\n    },\r\n    _createRemoveButton: function(handler) {\r\n        var $removeButton = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_IMAGE_CLASS).addClass(FILTER_BUILDER_IMAGE_REMOVE_CLASS).addClass(FILTER_BUILDER_ACTION_CLASS).attr(\"tabindex\", 0);\r\n        this._subscribeOnClickAndEnterKey($removeButton, handler);\r\n        return $removeButton\r\n    },\r\n    _createAddButton: function(addGroupHandler, addConditionHandler, groupLevel) {\r\n        var $button;\r\n        var maxGroupLevel = this.option(\"maxGroupLevel\");\r\n        if ((0, _type.isDefined)(maxGroupLevel) && groupLevel >= maxGroupLevel) {\r\n            $button = this._createButton();\r\n            this._subscribeOnClickAndEnterKey($button, addConditionHandler)\r\n        } else {\r\n            $button = this._createButtonWithMenu({\r\n                menu: {\r\n                    items: [{\r\n                        caption: _message2.default.format(\"dxFilterBuilder-addCondition\"),\r\n                        click: addConditionHandler\r\n                    }, {\r\n                        caption: _message2.default.format(\"dxFilterBuilder-addGroup\"),\r\n                        click: addGroupHandler\r\n                    }],\r\n                    displayExpr: \"caption\",\r\n                    onItemClick: function(e) {\r\n                        e.itemData.click()\r\n                    },\r\n                    cssClass: FILTER_BUILDER_ADD_CONDITION_CLASS\r\n                }\r\n            })\r\n        }\r\n        return $button.addClass(FILTER_BUILDER_IMAGE_CLASS).addClass(FILTER_BUILDER_IMAGE_ADD_CLASS).addClass(FILTER_BUILDER_ACTION_CLASS).attr(\"tabindex\", 0)\r\n    },\r\n    _createValueText: function(item, field, $container) {\r\n        var that = this;\r\n        var $text = (0, _renderer2.default)(\"<div>\").html(\"&nbsp;\").addClass(FILTER_BUILDER_ITEM_VALUE_TEXT_CLASS).attr(\"tabindex\", 0).appendTo($container);\r\n        var value = item[2];\r\n        var customOperation = _utils2.default.getCustomOperation(that._customOperations, item[1]);\r\n        if (!customOperation && field.lookup) {\r\n            _utils2.default.getCurrentLookupValueText(field, value, function(result) {\r\n                renderValueText($text, result)\r\n            })\r\n        } else {\r\n            _deferred2.default.when(_utils2.default.getCurrentValueText(field, value, customOperation)).done(function(result) {\r\n                renderValueText($text, result, customOperation)\r\n            })\r\n        }\r\n        that._subscribeOnClickAndEnterKey($text, function(e) {\r\n            if (\"keyup\" === e.type) {\r\n                e.stopPropagation()\r\n            }\r\n            that._createValueEditorWithEvents(item, field, $container)\r\n        });\r\n        return $text\r\n    },\r\n    _updateConditionValue: function(item, value, callback) {\r\n        var areValuesDifferent = item[2] !== value;\r\n        if (areValuesDifferent) {\r\n            item[2] = value\r\n        }\r\n        callback();\r\n        this._updateFilter()\r\n    },\r\n    _addDocumentKeyUp: function($editor, handler) {\r\n        var isComposing = false;\r\n        var hasCompositionJustEnded = false;\r\n        var document = _dom_adapter2.default.getDocument();\r\n        var documentKeyUpHandler = function(e) {\r\n            if (isComposing || hasCompositionJustEnded) {\r\n                hasCompositionJustEnded = false;\r\n                return\r\n            }\r\n            handler(e)\r\n        };\r\n        _events_engine2.default.on(document, \"keyup\", documentKeyUpHandler);\r\n        var input = $editor.find(\"input\");\r\n        _events_engine2.default.on(input, \"compositionstart\", function() {\r\n            isComposing = true\r\n        });\r\n        _events_engine2.default.on(input, \"compositionend\", function() {\r\n            isComposing = false;\r\n            hasCompositionJustEnded = true\r\n        });\r\n        _events_engine2.default.on(input, \"keydown\", function(event) {\r\n            if (229 !== event.which) {\r\n                hasCompositionJustEnded = false\r\n            }\r\n        });\r\n        this._documentKeyUpHandler = documentKeyUpHandler\r\n    },\r\n    _addDocumentClick: function($editor, closeEditorFunc) {\r\n        var _this6 = this;\r\n        var document = _dom_adapter2.default.getDocument();\r\n        var documentClickHandler = function(e) {\r\n            if (!_this6._isFocusOnEditorParts($editor, e.target)) {\r\n                _events_engine2.default.trigger($editor.find(\"input\"), \"change\");\r\n                closeEditorFunc()\r\n            }\r\n        };\r\n        _events_engine2.default.on(document, \"dxpointerdown\", documentClickHandler);\r\n        this._documentClickHandler = documentClickHandler\r\n    },\r\n    _isFocusOnEditorParts: function($editor, target) {\r\n        var activeElement = target || _dom_adapter2.default.getActiveElement();\r\n        return (0, _renderer2.default)(activeElement).closest($editor.children()).length || (0, _renderer2.default)(activeElement).closest(\".dx-dropdowneditor-overlay\").length\r\n    },\r\n    _removeEvents: function() {\r\n        var document = _dom_adapter2.default.getDocument();\r\n        (0, _type.isDefined)(this._documentKeyUpHandler) && _events_engine2.default.off(document, \"keyup\", this._documentKeyUpHandler);\r\n        (0, _type.isDefined)(this._documentClickHandler) && _events_engine2.default.off(document, \"dxpointerdown\", this._documentClickHandler)\r\n    },\r\n    _dispose: function() {\r\n        this._removeEvents();\r\n        this.callBase()\r\n    },\r\n    _createValueEditorWithEvents: function(item, field, $container) {\r\n        var _this7 = this;\r\n        var value = item[2];\r\n        var createValueText = function() {\r\n            $container.empty();\r\n            _this7._removeEvents();\r\n            return _this7._createValueText(item, field, $container)\r\n        };\r\n        var closeEditor = function() {\r\n            _this7._updateConditionValue(item, value, function() {\r\n                createValueText()\r\n            })\r\n        };\r\n        var options = {\r\n            value: \"\" === value ? null : value,\r\n            filterOperation: _utils2.default.getOperationValue(item),\r\n            setValue: function(data) {\r\n                value = null === data ? \"\" : data\r\n            },\r\n            closeEditor: closeEditor,\r\n            text: $container.text()\r\n        };\r\n        $container.empty();\r\n        var $editor = this._createValueEditor($container, field, options);\r\n        _events_engine2.default.trigger($editor.find(\"input\").not(\":hidden\").eq(0), \"focus\");\r\n        this._removeEvents();\r\n        this._addDocumentClick($editor, closeEditor);\r\n        this._addDocumentKeyUp($editor, function(e) {\r\n            var keyName = (0, _utils4.normalizeKeyName)(e);\r\n            if (keyName === TAB_KEY) {\r\n                if (_this7._isFocusOnEditorParts($editor)) {\r\n                    return\r\n                }\r\n                _this7._updateConditionValue(item, value, function() {\r\n                    createValueText();\r\n                    if (e.shiftKey) {\r\n                        _events_engine2.default.trigger($container.prev(), \"focus\")\r\n                    }\r\n                })\r\n            }\r\n            if (keyName === ESCAPE_KEY) {\r\n                _events_engine2.default.trigger(createValueText(), \"focus\")\r\n            }\r\n            if (keyName === ENTER_KEY) {\r\n                _this7._updateConditionValue(item, value, function() {\r\n                    _events_engine2.default.trigger(createValueText(), \"focus\")\r\n                })\r\n            }\r\n        });\r\n        this._fireContentReadyAction()\r\n    },\r\n    _createValueButton: function(item, field) {\r\n        var $valueButton = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_ITEM_VALUE_CLASS);\r\n        this._createValueText(item, field, $valueButton);\r\n        return $valueButton\r\n    },\r\n    _createValueEditor: function($container, field, options) {\r\n        var $editor = (0, _renderer2.default)(\"<div>\").attr(\"tabindex\", 0).appendTo($container);\r\n        var customOperation = _utils2.default.getCustomOperation(this._customOperations, options.filterOperation);\r\n        var editorTemplate = customOperation && customOperation.editorTemplate ? customOperation.editorTemplate : field.editorTemplate;\r\n        if (editorTemplate) {\r\n            var template = this._getTemplate(editorTemplate);\r\n            template.render({\r\n                model: (0, _extend.extend)({\r\n                    field: field\r\n                }, options),\r\n                container: $editor\r\n            })\r\n        } else {\r\n            this._editorFactory.createEditor.call(this, $editor, (0, _extend.extend)({}, field, options, {\r\n                parentType: SOURCE\r\n            }))\r\n        }\r\n        return $editor\r\n    },\r\n    _createPopupWithTreeView: function(options, $container) {\r\n        var that = this;\r\n        var $popup = (0, _renderer2.default)(\"<div>\").addClass(options.menu.cssClass).appendTo($container);\r\n        this._createComponent($popup, _popup2.default, {\r\n            onHiding: options.menu.onHiding,\r\n            onHidden: options.menu.onHidden,\r\n            rtlEnabled: options.menu.rtlEnabled,\r\n            position: options.menu.position,\r\n            animation: options.menu.animation,\r\n            contentTemplate: function(contentElement) {\r\n                var $menuContainer = (0, _renderer2.default)(\"<div>\").appendTo(contentElement);\r\n                that._createComponent($menuContainer, _tree_view2.default, options.menu);\r\n                this.repaint()\r\n            },\r\n            maxHeight: function() {\r\n                return (0, _utils3.getElementMaxHeightByWindow)(options.menu.position.of)\r\n            },\r\n            visible: true,\r\n            focusStateEnabled: false,\r\n            closeOnTargetScroll: this.option(\"closePopupOnTargetScroll\"),\r\n            closeOnOutsideClick: true,\r\n            onShown: options.popup.onShown,\r\n            shading: false,\r\n            width: \"auto\",\r\n            height: \"auto\",\r\n            showTitle: false\r\n        })\r\n    },\r\n    _subscribeOnClickAndEnterKey: function($button, handler) {\r\n        _events_engine2.default.on($button, \"dxclick\", handler);\r\n        _events_engine2.default.on($button, \"keyup\", function(e) {\r\n            if ((0, _utils4.normalizeKeyName)(e) === ENTER_KEY) {\r\n                handler(e)\r\n            }\r\n        })\r\n    }\r\n});\r\n(0, _component_registrator2.default)(\"dxFilterBuilder\", FilterBuilder);\r\nmodule.exports = FilterBuilder;\r\nmodule.exports.renderValueText = renderValueText;\r\n"]},"metadata":{},"sourceType":"script"}