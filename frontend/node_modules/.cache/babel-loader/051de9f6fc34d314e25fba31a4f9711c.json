{"ast":null,"code":"var fs = require('fs');\n\nvar path = require('path');\n\nvar multer = require('multer');\n\nvar imgModel = require('../../../models/Ticket');\n\nvar storage = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, 'uploads');\n  },\n  filename: (req, file, cb) => {\n    cb(null, file.fieldname + '-' + Date.now());\n  }\n});\nvar upload = multer({\n  storage: storage\n});\napp.get('/', (req, res) => {\n  imgModel.find({}, (err, items) => {\n    if (err) {\n      console.log(err);\n    } else {\n      res.render('app', {\n        items: items\n      });\n    }\n  });\n}); // Uploading the image \n\napp.post('/addTickets', upload.single('image'), (req, res, next) => {\n  var obj = {\n    name: req.body.name,\n    img: {\n      data: fs.readFileSync(path.join(__dirname + '/uploads/' + req.file.filename)),\n      contentType: 'image/png'\n    },\n    content: req.body.content,\n    messages: req.body.messages,\n    status: req.body.status,\n    userid: req.body.userid\n  };\n  imgModel.create(obj, (err, item) => {\n    if (err) {\n      console.log(err);\n    } else {\n      // item.save(); \n      res.redirect('/');\n    }\n  });\n});","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/ticketSystem/frontend/src/components/Tickets.js"],"names":["fs","require","path","multer","imgModel","storage","diskStorage","destination","req","file","cb","filename","fieldname","Date","now","upload","app","get","res","find","err","items","console","log","render","post","single","next","obj","name","body","img","data","readFileSync","join","__dirname","contentType","content","messages","status","userid","create","item","redirect"],"mappings":"AAAA,IAAIA,EAAE,GAAGC,OAAO,CAAC,IAAD,CAAhB;;AACA,IAAIC,IAAI,GAAGD,OAAO,CAAC,MAAD,CAAlB;;AACA,IAAIE,MAAM,GAAGF,OAAO,CAAC,QAAD,CAApB;;AACA,IAAIG,QAAQ,GAAGH,OAAO,CAAC,wBAAD,CAAtB;;AAEA,IAAII,OAAO,GAAGF,MAAM,CAACG,WAAP,CAAmB;AAC7BC,EAAAA,WAAW,EAAE,CAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,KAAmB;AAC5BA,IAAAA,EAAE,CAAC,IAAD,EAAO,SAAP,CAAF;AACH,GAH4B;AAI7BC,EAAAA,QAAQ,EAAE,CAACH,GAAD,EAAMC,IAAN,EAAYC,EAAZ,KAAmB;AACzBA,IAAAA,EAAE,CAAC,IAAD,EAAOD,IAAI,CAACG,SAAL,GAAiB,GAAjB,GAAuBC,IAAI,CAACC,GAAL,EAA9B,CAAF;AACH;AAN4B,CAAnB,CAAd;AASA,IAAIC,MAAM,GAAGZ,MAAM,CAAC;AAAEE,EAAAA,OAAO,EAAEA;AAAX,CAAD,CAAnB;AAEAW,GAAG,CAACC,GAAJ,CAAQ,GAAR,EAAa,CAACT,GAAD,EAAMU,GAAN,KAAc;AACvBd,EAAAA,QAAQ,CAACe,IAAT,CAAc,EAAd,EAAkB,CAACC,GAAD,EAAMC,KAAN,KAAgB;AAC9B,QAAID,GAAJ,EAAS;AACLE,MAAAA,OAAO,CAACC,GAAR,CAAYH,GAAZ;AACH,KAFD,MAGK;AACDF,MAAAA,GAAG,CAACM,MAAJ,CAAW,KAAX,EAAkB;AAAEH,QAAAA,KAAK,EAAEA;AAAT,OAAlB;AACH;AACJ,GAPD;AAQH,CATD,E,CAYA;;AACAL,GAAG,CAACS,IAAJ,CAAS,aAAT,EAAwBV,MAAM,CAACW,MAAP,CAAc,OAAd,CAAxB,EAAgD,CAAClB,GAAD,EAAMU,GAAN,EAAWS,IAAX,KAAoB;AAEnE,MAAIC,GAAG,GAAG;AACTC,IAAAA,IAAI,EAAErB,GAAG,CAACsB,IAAJ,CAASD,IADN;AAETE,IAAAA,GAAG,EAAE;AACJC,MAAAA,IAAI,EAAEhC,EAAE,CAACiC,YAAH,CAAgB/B,IAAI,CAACgC,IAAL,CAAUC,SAAS,GAAG,WAAZ,GAA0B3B,GAAG,CAACC,IAAJ,CAASE,QAA7C,CAAhB,CADF;AAEJyB,MAAAA,WAAW,EAAE;AAFT,KAFI;AAMTC,IAAAA,OAAO,EAAE7B,GAAG,CAACsB,IAAJ,CAASO,OANT;AAOTC,IAAAA,QAAQ,EAAC9B,GAAG,CAACsB,IAAJ,CAASQ,QAPT;AAQTC,IAAAA,MAAM,EAAC/B,GAAG,CAACsB,IAAJ,CAASS,MARP;AASTC,IAAAA,MAAM,EAAEhC,GAAG,CAACsB,IAAJ,CAASU;AATR,GAAV;AAWApC,EAAAA,QAAQ,CAACqC,MAAT,CAAgBb,GAAhB,EAAqB,CAACR,GAAD,EAAMsB,IAAN,KAAe;AACnC,QAAItB,GAAJ,EAAS;AACRE,MAAAA,OAAO,CAACC,GAAR,CAAYH,GAAZ;AACA,KAFD,MAGK;AACJ;AACAF,MAAAA,GAAG,CAACyB,QAAJ,CAAa,GAAb;AACA;AACD,GARD;AASA,CAtBD","sourcesContent":["var fs = require('fs'); \r\nvar path = require('path'); \r\nvar multer = require('multer'); \r\nvar imgModel = require('../../../models/Ticket'); \r\n\r\nvar storage = multer.diskStorage({ \r\n    destination: (req, file, cb) => { \r\n        cb(null, 'uploads') \r\n    }, \r\n    filename: (req, file, cb) => { \r\n        cb(null, file.fieldname + '-' + Date.now()) \r\n    } \r\n}); \r\n  \r\nvar upload = multer({ storage: storage }); \r\n\r\napp.get('/', (req, res) => { \r\n    imgModel.find({}, (err, items) => { \r\n        if (err) { \r\n            console.log(err); \r\n        } \r\n        else { \r\n            res.render('app', { items: items }); \r\n        } \r\n    }); \r\n}); \r\n\r\n\r\n// Uploading the image \r\napp.post('/addTickets', upload.single('image'), (req, res, next) => { \r\n\r\n\tvar obj = { \r\n\t\tname: req.body.name, \r\n\t\timg: { \r\n\t\t\tdata: fs.readFileSync(path.join(__dirname + '/uploads/' + req.file.filename)), \r\n\t\t\tcontentType: 'image/png'\r\n\t\t},\r\n\t\tcontent: req.body.content,\r\n\t\tmessages:req.body.messages,\r\n\t\tstatus:req.body.status,\r\n\t\tuserid: req.body.userid,\r\n\t} \r\n\timgModel.create(obj, (err, item) => { \r\n\t\tif (err) { \r\n\t\t\tconsole.log(err); \r\n\t\t} \r\n\t\telse { \r\n\t\t\t// item.save(); \r\n\t\t\tres.redirect('/'); \r\n\t\t} \r\n\t}); \r\n}); \r\n"]},"metadata":{},"sourceType":"module"}